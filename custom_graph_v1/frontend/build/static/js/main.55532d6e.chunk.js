(this.webpackJsonpstreamlit_custom_graph=this.webpackJsonpstreamlit_custom_graph||[]).push([[0],{14:function(t,e,a){t.exports=a(30)},30:function(t,e,a){"use strict";a.r(e);var s=a(2),o=a.n(s),r=a(12),i=a.n(r),n=a(8),l=a(6),c=a.n(l),h=a(7),p=a.n(h),d=(a(23),a(32)),m=a(9),g=n.a.CanvasJSChart,u=n.a.CanvasJS;const _=[[],[],[],[],[],[],[],[],[],[]];p.a.options={positionClass:"toast-top-full-width",hideDuration:300,timeOut:3e3};class x extends s.Component{constructor(t){super(t),this.state={viewId:0},this.updateChart=this.updateChart.bind(this),this.toggleDataSeries=this.toggleDataSeries.bind(this)}componentDidMount(){const{kwargs:t}=this.props.args,{y_axis:e,api:a,y_max:s,refresh_sec:o,graph_height:r}=t;m.a.setFrameHeight(),this.updateChart(),o&&setInterval(this.updateChart,1e3*o)}componentDidUpdate(t){t.viewId!==this.state.viewId&&this.updateChart()}toggleDataSeries(t){"undefined"===typeof t.dataSeries.visible||t.dataSeries.visible?t.dataSeries.visible=!1:t.dataSeries.visible=!0,this.chart.render()}async fetchGraphData(){const{kwargs:t}=this.props.args,{y_axis:e,api:a,y_max:s,refresh_sec:o,toggles:r}=t,{viewId:i}=this.state,n=await d.a.post(a,{...t,toggles_selection:r?r[i]:"none"});return console.log("toggles[viewId],viewId :>> ",r[i],i),JSON.parse(n.data)}async updateChart(){const{kwargs:t}=this.props.args,{x_axis:e,y_axis:a,api:s,y_max:o,refresh_sec:r,refresh_button:i,theme_options:n}=t;try{const t=await this.fetchGraphData(),s=[];for(a.map((a,o)=>s[o]=t.map((t,s)=>({x:s,y:t[a.field],timeStamp:t[e.field]})));_[0].length;)a.map((t,e)=>{_[e].pop()});a.map((t,e)=>{_[e].push(...s[e]),this.chart.options.data[e].legendText=t.name+s[e].pop().y}),this.chart.options.axisX.labelFormatter=function(t){const e=_[0][t.value];return c()(e.timeStamp).format("MM/DD/YY hh")},this.chart.render(),i&&!r&&p.a.success("Success!")}catch(l){i&&!r&&p.a.error("Fetch Error: ".concat(l.message))}}render(){const t=[],{kwargs:e}=this.props.args;console.log(this.props);const{viewId:a}=this.state;console.log(e);const{y_axis:s,api:r,y_max:i,refresh_sec:n,theme_options:l,refresh_button:h,toggles:p}=e,d=s.map((e,a)=>(t.push(e.color),{type:"spline",xValueFormatString:"#.##0 ",yValueFormatString:"#.##0",showInLegend:l.showInLegend,name:e.name,dataPoints:_[a]}));u.addColorSet("greenShades",t);const m={colorSet:"greenShades",backgroundColor:l.backgroundColor?l.backgroundColor:"white",zoomEnabled:!0,title:{text:l.main_title?l.main_title:""},axisX:{title:l.x_axis_title?l.x_axis_title:"",labelFormatter:t=>c()(t.value).format("MM/DD/YY hh"),labelFontSize:12},axisY:{suffix:"",maximum:i||null,gridColor:l.grid_color?l.grid_color:""},toolTip:{shared:!0,contentFormatter:function(t){let e="";const a=c()(t.entries[0].dataPoint.timeStamp).format("MM/DD/YY HH:mm");e+="<strong>Date</strong>: ".concat(a,"<br/>");for(let s=1;s<t.entries.length;s++){const a=t.entries[s],o=a.dataSeries,r=a.dataPoint,i=o.color?o.color:o.options.color;e+='<strong style="color: '.concat(i,'">').concat(o.name,"</strong>: ").concat(r.y,"<br/>")}return e}},legend:{cursor:"pointer",verticalAlign:"top",fontSize:18,fontColor:"dimGrey",itemclick:this.toggleDataSeries},data:d,height:e.graph_height?e.graph_height:400};return o.a.createElement("div",null,h&&!n&&o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{style:{margin:"10px 10px 10px 2px"}},o.a.createElement("button",{className:"btn btn-warning",onClick:this.updateChart},"Refresh"))),o.a.createElement(g,{options:m,onRef:t=>this.chart=t}),o.a.createElement("div",{className:"d-flex flex-row gap-6"},null===p||void 0===p?void 0:p.map((t,e)=>o.a.createElement("span",{className:""},o.a.createElement("button",{className:"btn ".concat(a==e?"btn-danger":"btn-secondary"),onClick:()=>this.setState({viewId:e})},t)))))}}var f=Object(m.b)(x);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(f,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.55532d6e.chunk.js.map