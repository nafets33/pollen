{"version":3,"sources":["components/Modal.tsx","utils.js","Aggrid.tsx","Main.tsx","index.tsx"],"names":["formats","sliderRules","sliderRules_stars","sliderRules_stars_margin","map","rule","concat","ReactModal","setAppElement","isExecuting","MyModal","_ref","isOpen","closeModal","modalData","promptText","setPromptText","toastr","prompt_field","prompt_order_rules","selectedRow","selectedField","add_symbol_row_info","display_grid_column","editableCols","showStarsSliders","setShowStarsSliders","React","useState","showStarsMarginSliders","setShowStarsMarginSliders","showActiveOrders","setShowActiveOrders","showWaveData","setShowWaveData","showButtonColData","setShowButtonColData","sellQtys","setSellQtys","handleSellQtyChange","idx","value","prev","ref","useRef","useEffect","setTimeout","_ref$current","current","focus","isValidDate","dateStr","some","format","moment","isValid","formatToLocalDatetime","date","toDate","timeZone","Intl","DateTimeFormat","resolvedOptions","zonedDate","utcToZonedTime","textFields","booleanFields","datetimeFields","arrayFields","Array","isArray","filter","field","push","createElement","onRequestClose","ariaHideApp","className","style","position","prompt_message","onClick","right","left","type","async","body","username","prod","selected_row","default_value","kwargs","console","log","data","res","axios","post","button_api","status","description","message_type","success","alert","error","close_modal","message","length","index","key","marginRight","minWidth","textAlign","fontSize","checked","onChange","e","target","width","height","marginTop","flex","includes","isSliderRule","marginLeft","cursor","title","Fragment","min","max","step","Number","fontWeight","padding","item","i","marginBottom","undefined","col","toLocaleString","maximumFractionDigits","String","active_orders","margin","ordersToRender","overflowX","Object","keys","order","qty_available","num","updatedOrders","ord","sell_qty","active_orders_with_qty","wave_data","mapObject","obj","fn","keysToIgnore","reduce","deepMap","arguments","deepMapper","val","g_rowdata","g_newRowData","dateFormatter","isoString","formaterString","Date","currencyFormatter","number","currencySymbol","n","parseFloat","isNaN","toFixed","numberFormatter","precision","HyperlinkRenderer","props","linkField","column","colDef","baseURL","linkValue","href","rel","options","positionClass","hideDuration","timeOut","AgGrid","BtnCellRenderer","btnClickedHandler","clicked","node","id","background","border","cellStyle","col_header","buttonName","gridRef","api","api_update","refresh_sec","refresh_cutoff_sec","enable_JsCode","grid_options","parseJsCodeFromPython","subtotalsRow","setSubtotalsRow","buttons","toggle_views","api_key","api_lastmod_key","columnOrder","refresh_success","total_col","subtotal_cols","filter_button","rowData","setRowData","modalShow","setModalshow","setModalData","viewId","setViewId","lastModified","setLastModified","previousViewId","setpreviousViewId","activeFilter","setActiveFilter","_gridRef$current","Streamlit","setFrameHeight","forEach","button","col_headername","col_width","pinned","button_name","border_color","otherKeys","filterParams","columnDefs","headerName","cellRenderer","cellRendererParams","borderColor","row_index","find","row","str","JSON","parse","replace","rules_value","window","confirm","sort","a","b","indexOf","refreshHeader","fetchAndSetData","array","fetchData","onRefresh","toggle_view","currentViewId","checkViewIdChanged","_res$data","baseurl","split","slice","join","get","params","client_user","checkLastModified","toggle_view_selection","calculateSubtotals","useCallback","filteredRows","forEachNodeAfterFilterAndSort","subtotal","allCols","Boolean","btn","sum","match","onFilterChanged","interval","setInterval","timeout","clearInterval","clearTimeout","skipHeader","allColumnIds","columnApi","getColumns","getId","autoSizeColumns","sizeColumnsToFit","defaultMinWidth","onGridReady","autoGroupColumnDef","useMemo","getRowId","sideBar","toolPanels","labelDefault","labelKey","iconKey","toolPanel","defaultToolPanel","onCellValueChanged","event","loading","setLoading","columnTypes","dateColumnFilter","comparator","filterValue","cellValue","compareAsc","numberColumnFilter","shortDateTimeFormat","valueFormatter","customDateTimeFormat","custom_format_string","customNumericFormat","_params$column$colDef2","customCurrencyFormat","custom_currency_symbol","timedeltaFormat","duration","humanize","customNumberFormat","minimumFractionDigits","customHyperlinkRenderer","v","RegExp","exec","funcStr","Function","buttonStyle","uniqueValues","getUniqueColumnValues","from","Set","handleButtonFilter","setFilterModel","getFilterModel","filterType","values","model","flexDirection","display","backgroundColor","color","borderRadius","alignItems","justifyContent","disabled","borderTop","animation","new_data","warning","flexWrap","gap","view","gridTemplateColumns","overflowY","maxHeight","theme","streaming_list_text","borderBottom","whiteSpace","overflow","textOverflow","paddingLeft","boxShadow","transition","AgGridReact","pinnedBottomRowData","getRowStyle","_params$data$color_ro","_params$data$color_ro2","rowStyle","headerHeight","rowHeight","animateRows","suppressAggFuncInHeader","gridOptions","getGridOptions","nestedGridEnabled","nested_columnDefs","masterDetail","detailCellRendererParams","detailGridOptions","getDetailRowData","successCallback","nestedRows","withStreamlitConnection","gridoption_build","args","Aggrid","ReactDOM","render","StrictMode","Main","document","getElementById"],"mappings":"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","file":"static/js/main.fefdb512.chunk.js","sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport ReactModal from \"react-modal\";\nimport \"./modal.css\";\nimport axios from \"axios\";\nimport { utcToZonedTime, format } from 'date-fns-tz';\nimport moment from \"moment\";\n\nconst formats = [\"YYYY-MM-DDTHH:mm\", \"MM/DD/YYYYTHH:mm\", \"MM/DD/YYYY HH:mm\", \"YYYY-MM-DD HH:mm\"];\nconst sliderRules = [\"buying_power\", \"borrow_power\"]\nconst sliderRules_stars = [\"Day\", \"Week\", \"Month\", \"Quarter\", \"Quarters\", \"Year\"];\nconst sliderRules_stars_margin = sliderRules_stars.map(rule => `${rule} Margin`);\n\n\n\n// const modalStyle = {\n//   content: {\n//     top: \"50%\",\n//     left: \"50%\",\n//     right: \"auto\",\n//     bottom: \"auto\",\n//     marginRight: \"-50%\",\n//     transform: \"translate(-50%, -50%)\",\n//     backgroundColor: \"yellow\",\n//     width: \"95vw\",           // Responsive width\n//     maxWidth: \"400px\",       // Limit max width for desktop\n//     minWidth: \"280px\",       // Minimum for mobile\n//     padding: \"16px\",\n//   },\n// };\n\nReactModal.setAppElement(\"#root\");\nlet isExecuting = false;\n\ninterface MyModalProps {\n  isOpen: boolean;\n  closeModal: () => void;\n  modalData: any;\n  promptText: any;\n  setPromptText: (value: any) => void;\n  toastr: any; // Define the toastr type if available\n}\n\nconst MyModal: React.FC<MyModalProps> = ({\n  isOpen,\n  closeModal,\n  modalData,\n  promptText,\n  setPromptText,\n  toastr,\n}) => {\n  const { prompt_field, prompt_order_rules, selectedRow, selectedField, add_symbol_row_info, display_grid_column, editableCols } = modalData;\n  // console.log(\"modalData :>> \", display_grid_column, prompt_field); // workerbee handle in agagrid display_grid_column add var from mount\n  const [showStarsSliders, setShowStarsSliders] = React.useState(false);\n  const [showStarsMarginSliders, setShowStarsMarginSliders] = React.useState(false);\n  const [showActiveOrders, setShowActiveOrders] = React.useState(false);\n  const [showWaveData, setShowWaveData] = React.useState(false);\n  const [showButtonColData, setShowButtonColData] = React.useState(false);\n  const [sellQtys, setSellQtys] = React.useState<{ [key: number]: string }>({});\n  const handleSellQtyChange = (idx: number, value: string) => {\n    setSellQtys((prev) => ({ ...prev, [idx]: value }));\n  };\n  \n  const ref = useRef<HTMLButtonElement>(null);\n  const selectRef = useRef<HTMLSelectElement>(null);\n\n  // const editableCols = [\"allocation_long\", \"buy_amount\"];\n  // console.log(\"editableCols :>> \", editableCols);\n\n\n  const handleOk = async () => {\n    if (isExecuting) return;\n    isExecuting = true;\n    try {\n      const { data: res } = await axios.post(modalData.button_api, {\n        username: modalData.username,\n        prod: modalData.prod,\n        selected_row: modalData.selectedRow,\n        default_value: promptText,\n        ...modalData.kwargs,\n      });\n      const { status, data, description } = res;\n      console.log(\"res :>> \", res);\n      if (status === \"success\") {\n        data.message_type === \"fade\"\n          ? toastr.success(description, \"Success\")\n          : alert(\"Success!\\nDescription: \" + description);\n      } else {\n        data.message_type === \"fade\"\n          ? toastr.error(description, \"Error\")\n          : alert(\"Error!\\nDescription: \" + description);\n      }\n      if (data?.close_modal != false) closeModal();\n    } catch (error: any) {\n      console.log(\"error :>> \", error);\n      toastr.error(error.message);\n    }\n    isExecuting = false;\n  };\n\n  const handleOkSecond = async () => {\n    if (isExecuting) return;\n    isExecuting = true;\n    try {\n      const body = {\n        username: modalData.username,\n        prod: modalData.prod,\n        selected_row: modalData.selectedRow,\n        default_value: promptText,\n        ...modalData.kwargs,\n      };\n      console.log(\"body :>> \", body);\n      const { data: res } = await axios.post(modalData.button_api, body);\n      const { status, data, description } = res;\n      if (status === \"success\") {\n        data.message_type === \"fade\"\n          ? toastr.success(description, \"Success\")\n          : alert(\"Success!\\nDescription: \" + description);\n      } else {\n        data.message_type === \"fade\"\n          ? toastr.error(description, \"Error\")\n          : alert(\"Error!\\nDescription: \" + description);\n      }\n      if (data?.close_modal != false) closeModal();\n    } catch (error: any) {\n      console.log(\"error :>> \", error);\n      toastr.error(error.message);\n    }\n    isExecuting = false;\n  };\n\n\n  useEffect(() => {\n    if (isOpen) setTimeout(() => ref.current?.focus(), 100);\n  }, [isOpen]);\n\n  useEffect(() => {\n  setSellQtys({}); // Reset sellQtys to an empty object\n}, [isOpen, selectedRow]);\n\n  const isValidDate = (dateStr: string) => {\n    return formats.some(format => moment(dateStr, format, true).isValid());\n  };\n\n  const formatToLocalDatetime = (dateStr: string) => {\n    const date = moment(dateStr, formats, true).toDate();\n    const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n    const zonedDate = utcToZonedTime(date, timeZone);\n    return format(zonedDate, 'yyyy-MM-dd\\'T\\'HH:mm');\n  };\n\n  // Categorize fields by type\n  const textFields = [];\n  const booleanFields = [];\n  const datetimeFields = [];\n  const arrayFields = [];\n\n  const filtered_prompt_order_rules = Array.isArray(prompt_order_rules) && promptText\n  ? prompt_order_rules.filter((field) => field && (field in promptText))\n  : [];\n  // console.log(\"filtered_prompt_order_rules :>> \", filtered_prompt_order_rules);\n\n  if (prompt_order_rules) {\n    for (const rule of prompt_order_rules) {\n      const value = promptText[rule];\n      if (Array.isArray(value)) {\n        arrayFields.push(rule);\n      } else if (typeof value === \"boolean\") {\n        booleanFields.push(rule);\n      } else if (isValidDate(value)) {\n        datetimeFields.push(rule);\n      } else {\n        textFields.push(rule);\n      }\n    }\n  }\n\n\nreturn (\n  <ReactModal\n    isOpen={isOpen}\n    onRequestClose={closeModal}\n    // style={modalStyle}\n    ariaHideApp={false}\n  >\n    <div className=\"my-modal-content\">\n      {/* Modal Header */}\n      <div className=\"modal-header px-3 d-flex justify-content-center align-items-center\" style={{ position: \"relative\" }}>\n      <h4 className=\"text-center m-0\">{modalData.prompt_message}</h4>\n      <span className=\"close\" onClick={closeModal} style={{ position: \"absolute\", right: \"20px\" }}>\n        &times;\n      </span>\n      {/* Modal Footer Buttons at Top */}\n      <div className=\"d-flex\" style={{ position: \"absolute\", left: \"20px\" }}>\n        <button type=\"button\" className=\"btn btn-primary mx-2\" onClick={handleOkSecond} ref={ref}>\n        Ok\n        </button>\n        <button type=\"button\" className=\"btn btn-secondary mx-2\" onClick={closeModal}>\n        Cancel\n        </button>\n      </div>\n      </div>\n\n      {/* Modal Body */}\n      <div className=\"modal-body p-3\">\n        <div className=\"d-flex flex-column\">\n          {/* Boolean Fields Top Row */}\n          {booleanFields.length > 0 && (\n            <div className=\"d-flex flex-row justify-content-between mb-2\">\n              {booleanFields.map((rule: any, index: number) => (\n                <div className=\"d-flex flex-column align-items-center\" key={index} style={{ marginRight: \"8px\" }}>\n                  <label className=\"mb-0\" style={{ minWidth: \"100px\", textAlign: \"center\", fontSize: \"0.9rem\" }}>\n                    {rule}:\n                  </label>\n                  <input\n                    type=\"checkbox\"\n                    checked={promptText[rule]}\n                    onChange={(e) =>\n                      setPromptText({\n                        ...promptText,\n                        [rule]: e.target.checked,\n                      })\n                    }\n                    style={{ width: \"16px\", height: \"16px\", marginTop: \"4px\" }}\n                  />\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Other Fields (Text, Datetime, Array Fields) */}\n          <div className=\"d-flex flex-row justify-content-between\">\n            {/* Text Fields Column */}\n            {textFields.length > 0 && (\n              <div className=\"d-flex flex-column\" style={{ flex: 1, marginRight: \"8px\" }}>\n                {textFields.map((rule: any, index: number) => {\n                  if (sliderRules_stars.includes(rule)) return null;\n                  if (sliderRules_stars_margin.includes(rule)) return null;\n                  const isSliderRule = sliderRules.includes(rule);\n                  return (\n                    <div className=\"d-flex flex-column align-items-start mb-1\" key={index}>\n                      <label className=\"mb-0\" style={{ fontSize: \"0.9rem\" }}>\n                        {rule}:\n                        {rule === \"sell_amount\" && (\n                          <span\n                            style={{ marginLeft: \"4px\", cursor: \"pointer\" }}\n                            title=\"This amount will override sell_qty\"\n                          >\n                            ❓\n                          </span>\n                        )}\n                      </label>\n                      {isSliderRule ? (\n                        <>\n                          <input\n                            type=\"range\"\n                            min=\"0\"\n                            max=\"1\"\n                            step=\".01\"\n                            value={promptText[rule] || 0}\n                            onChange={(e) =>\n                              setPromptText({\n                                ...promptText,\n                                [rule]: Number(e.target.value),\n                              })\n                            }\n                            style={{ width: \"100%\" }}\n                          />\n                          <span style={{ fontSize: \"0.9rem\", fontWeight: \"bold\", marginTop: \"4px\" }}>\n                            {promptText[rule] || 0}\n                          </span>\n                        </>\n                      ) : (\n                        <input\n                          type=\"text\"\n                          value={promptText[rule]}\n                          onChange={(e) =>\n                            setPromptText({\n                              ...promptText,\n                              [rule]: e.target.value,\n                            })\n                          }\n                          style={{ flex: 1, width: \"100%\", padding: \"4px\", fontSize: \"0.9rem\" }}\n                        />\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n\n            {/* Array Fields Column */}\n            {arrayFields.length > 0 && (\n              <div className=\"d-flex flex-column\" style={{ flex: 1 }}>\n                {arrayFields.map((rule: any, index: number) => (\n                  <div className=\"d-flex flex-column align-items-start mb-1\" key={index}>\n                    <label className=\"mb-0\" style={{ fontSize: \"0.9rem\" }}>\n                      {rule}:\n                    </label>\n                    <select\n                      value={promptText[rule][0]}\n                      onChange={(e) =>\n                        setPromptText({\n                          ...promptText,\n                          [rule]: [e.target.value],\n                        })\n                      }\n                      style={{ flex: 1, width: \"100%\", padding: \"4px\", fontSize: \"0.9rem\" }}\n                    >\n                      {promptText[rule].map((item: any, i: number) => (\n                        <option key={i} value={item}>\n                          {item}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {/* Expander for sliderRules_stars */}\n            {sliderRules_stars.some((rule: any) => prompt_order_rules?.includes(rule)) && (\n              <div style={{ flex: 1, marginRight: \"8px\" }}>\n                <div\n                  style={{ cursor: \"pointer\", fontWeight: \"bold\", marginBottom: \"4px\" }}\n                  onClick={() => setShowStarsSliders((prev) => !prev)}\n                >\n                  {showStarsSliders ? \"▼\" : \"►\"} Advanced Allocation Options\n                </div>\n                {showStarsSliders && (\n                  <div>\n                    {sliderRules_stars.map((rule: any, index: number) =>\n                      prompt_order_rules?.includes(rule) && promptText[rule] !== undefined && (\n                        <div className=\"d-flex flex-column align-items-start mb-1\" key={index}>\n                          <label className=\"mb-0\" style={{ fontSize: \"0.9rem\" }}>\n                            {rule}:\n                          </label>\n                          <input\n                            type=\"range\"\n                            min=\"0\"\n                            max=\"1\"\n                            step=\".01\"\n                            value={promptText[rule] || 0}\n                            onChange={(e) =>\n                              setPromptText({\n                                ...promptText,\n                                [rule]: Number(e.target.value),\n                              })\n                            }\n                            style={{ width: \"100%\" }}\n                          />\n                          <span style={{ fontSize: \"0.9rem\", fontWeight: \"bold\", marginTop: \"4px\" }}>\n                            {promptText[rule] || 0}\n                          </span>\n                        </div>\n                      )\n                    )}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Expander for sliderRules_stars_margin */}\n            {sliderRules_stars_margin.some((rule: any) => prompt_order_rules?.includes(rule)) && (\n              <div style={{ flex: 1, marginRight: \"8px\" }}>\n                <div\n                  style={{ cursor: \"pointer\", fontWeight: \"bold\", marginBottom: \"4px\" }}\n                  onClick={() => setShowStarsMarginSliders((prev) => !prev)}\n                >\n                  {showStarsMarginSliders ? \"▼\" : \"►\"} Advanced Margin Allocation Options\n                </div>\n                {showStarsMarginSliders && (\n                  <div>\n                    {sliderRules_stars_margin.map((rule: any, index: number) =>\n                      prompt_order_rules?.includes(rule) && promptText[rule] !== undefined && (\n                        <div className=\"d-flex flex-column align-items-start mb-1\" key={index}>\n                          <label className=\"mb-0\" style={{ fontSize: \"0.9rem\" }}>\n                            {rule}:\n                          </label>\n                          <input\n                            type=\"range\"\n                            min=\"0\"\n                            max=\"1\"\n                            step=\".01\"\n                            value={promptText[rule] || 0}\n                            onChange={(e) =>\n                              setPromptText({\n                                ...promptText,\n                                [rule]: Number(e.target.value),\n                              })\n                            }\n                            style={{ width: \"100%\" }}\n                          />\n                          <span style={{ fontSize: \"0.9rem\", fontWeight: \"bold\", marginTop: \"4px\" }}>\n                            {promptText[rule] || 0}\n                          </span>\n                        </div>\n                      )\n                    )}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Datetime Fields Column */}\n            {datetimeFields.length > 0 && (\n              <div className=\"d-flex flex-column\" style={{ flex: 1, marginRight: \"8px\" }}>\n                {datetimeFields.map((rule: any, index: number) => (\n                  <div className=\"d-flex flex-column align-items-start mb-1\" key={index}>\n                    <label className=\"mb-0\" style={{ fontSize: \"0.9rem\" }}>\n                      {rule}:\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={promptText[rule] && formatToLocalDatetime(promptText[rule])}\n                      onChange={(e) =>\n                        setPromptText({\n                          ...promptText,\n                          [rule]: e.target.value,\n                        })\n                      }\n                      style={{ flex: 1, width: \"100%\", padding: \"4px\", fontSize: \"0.9rem\" }}\n                    />\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Add Symbol Row Info Column */}\n      {add_symbol_row_info && Array.isArray(add_symbol_row_info) && (\n        <div className=\"d-flex flex-column\" style={{ flex: 1 }}>\n          {add_symbol_row_info.map((col: string) => (\n            selectedRow && selectedRow[col] !== undefined && (\n              <div key={col}>\n                <b>{col}: </b>\n                {typeof selectedRow[col] === \"number\"\n                  ? Number(selectedRow[col]).toLocaleString(undefined, { maximumFractionDigits: 2 })\n                  : String(selectedRow[col])}\n              </div>\n            )\n          ))}\n        </div>\n      )}\n\n      {/* Active Orders Table */}\n      {prompt_field === \"sell_option\" &&\n        selectedRow &&\n        Array.isArray(selectedRow.active_orders) &&\n        selectedRow.active_orders.length > 0 && (\n          <div style={{ margin: \"16px 0\" }}>\n            <div\n              style={{ cursor: \"pointer\", fontWeight: \"bold\", marginBottom: \"4px\" }}\n              onClick={() => setShowActiveOrders((prev: boolean) => !prev)}\n            >\n              {showActiveOrders ? \"▼\" : \"►\"} Active Orders\n            </div>\n            {showActiveOrders && (() => {\n              const ordersToRender = selectedRow.active_orders;\n              return (\n                <div style={{ overflowX: \"auto\" }}>\n                  <table className=\"table table-bordered table-sm\" style={{ fontSize: \"0.8rem\" }}>\n                    <thead>\n                      <tr>\n                        {Object.keys(ordersToRender[0]).map((col) => (\n                          <th key={col}>{col}</th>\n                        ))}\n                        <th>sell_qty</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {ordersToRender.map((order: any, idx: number) => (\n                        <tr key={idx}>\n                          {Object.keys(ordersToRender[0]).map((col) => (\n                            <td key={col}>\n                              {order && order[col] !== undefined ? String(order[col]) : \"\"}\n                            </td>\n                          ))}\n                          <td>\n                            <input\n                              type=\"number\"\n                              min={0}\n                              max={order.qty_available}\n                              value={sellQtys[idx] || \"\"}\n                              onChange={e => {\n                                let value = e.target.value;\n                                if (value === \"\") {\n                                  handleSellQtyChange(idx, \"\");\n                                  return;\n                                }\n                                let num = Number(value);\n                                if (num < 0) num = 0;\n                                if (order.qty_available !== undefined && num > order.qty_available) num = order.qty_available;\n                                handleSellQtyChange(idx, String(num));\n                                const updatedOrders = ordersToRender.map((ord: any, i: number) => ({\n                                  ...ord,\n                                  sell_qty: i === idx ? String(num) : (sellQtys[i] !== undefined && sellQtys[i] !== \"\" ? sellQtys[i] : \"\")\n                                }));\n                                setPromptText({\n                                  ...promptText,\n                                  active_orders_with_qty: updatedOrders\n                                });\n                              }}\n                              style={{ width: \"80px\", fontSize: \"0.8rem\" }}\n                            />\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              );\n            })()}\n          </div>\n      )}\n\n      {/* Wave Data Table */}\n      {prompt_field === \"kors\" &&\n        selectedRow &&\n        Array.isArray(selectedRow['wave_data']) &&\n        selectedRow['wave_data'].length > 0 && (\n          <div style={{ margin: \"16px 0\" }}>\n            <div\n              style={{ cursor: \"pointer\", fontWeight: \"bold\", marginBottom: \"4px\" }}\n              onClick={() => setShowWaveData((prev: boolean) => !prev)}\n            >\n              {showWaveData ? \"▼\" : \"►\"} Show Buy Time Set Allocations\n            </div>\n            {showWaveData && (() => {\n              const ordersToRender = selectedRow['wave_data'];\n              return (\n                <div style={{ overflowX: \"auto\" }}>\n                  <table className=\"table table-bordered table-sm\" style={{ fontSize: \"0.8rem\" }}>\n                    <thead>\n                      <tr>\n                        {Object.keys(ordersToRender[0]).map((col) => (\n                          <th key={col}>{col}</th>\n                        ))}\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {(promptText.wave_data || ordersToRender).map((order: any, idx: number) => (\n                        <tr key={idx}>\n                          {Object.keys(ordersToRender[0]).map((col) => (\n                            <td key={col}>\n                              {Array.isArray(editableCols) && editableCols.includes(col) ? (\n                                <input\n                                  type=\"number\"\n                                  value={order[col] || \"\"}\n                                  onChange={e => {\n                                    const value = e.target.value;\n                                    const currentWaveData = promptText.wave_data\n                                      ? [...promptText.wave_data]\n                                      : [...ordersToRender];\n                                    const updatedOrders = currentWaveData.map((ord: any, i: number) =>\n                                      i === idx ? { ...ord, [col]: value } : ord\n                                    );\n                                    setPromptText({\n                                      ...promptText,\n                                      wave_data: updatedOrders\n                                    });\n                                  }}\n                                  style={{ width: \"80px\", fontSize: \"0.8rem\" }}\n                                />\n                              ) : (\n                                order && order[col] !== undefined\n                                  ? typeof order[col] === \"number\"\n                                    ? Number(order[col]).toLocaleString(undefined, { maximumFractionDigits: 2 })\n                                    : String(order[col])\n                                  : \"\"\n                              )}\n                            </td>\n                          ))}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              );\n            })()}\n          </div>\n      )}\n\n      {/* Display Grid Column Table */}\n      {display_grid_column &&\n        selectedRow &&\n        Array.isArray(selectedRow[display_grid_column]) &&\n        selectedRow[display_grid_column].length > 0 && (\n          <div style={{ margin: \"16px 0\" }}>\n            <div\n              style={{ cursor: \"pointer\", fontWeight: \"bold\", marginBottom: \"4px\" }}\n              onClick={() => setShowButtonColData((prev: boolean) => !prev)}\n            >\n              {showButtonColData ? \"▼\" : \"►\"} {display_grid_column}\n            </div>\n            {showButtonColData && (() => {\n              const ordersToRender = selectedRow[display_grid_column];\n              return (\n                <div style={{ overflowX: \"auto\" }}>\n                  <table className=\"table table-bordered table-sm\" style={{ fontSize: \"0.6rem\" }}>\n                    <thead>\n                      <tr>\n                        {Object.keys(ordersToRender[0]).map((col) => (\n                          <th key={col}>{col}</th>\n                        ))}\n                        <th>Buy Amount</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {ordersToRender.map((order: any, idx: number) => (\n                        <tr key={idx}>\n                          {Object.keys(ordersToRender[0]).map((col) => (\n                            <td key={col}>\n                              {order && order[col] !== undefined\n                                ? typeof order[col] === \"number\"\n                                  ? Number(order[col]).toLocaleString(undefined, { maximumFractionDigits: 2 })\n                                  : String(order[col])\n                                : \"\"}\n                            </td>\n                          ))}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              );\n            })()}\n          </div>\n      )}\n\n      {/* Modal Footer */}\n      {/* <div className=\"modal-footer d-flex justify-content-center\">\n        <button type=\"button\" className=\"btn btn-primary mx-2\" onClick={handleOkSecond} ref={ref}>\n          Ok\n        </button>\n        <button type=\"button\" className=\"btn btn-secondary mx-2\" onClick={closeModal}>\n          Cancel\n        </button>\n      </div> */}\n    </div>\n  </ReactModal>\n);\n  \n};\n\nexport default MyModal;\n","// stole from https://github.com/andfanilo/streamlit-echarts/blob/master/streamlit_echarts/frontend/src/utils.js Thanks andfanilo\nfunction mapObject(obj, fn, keysToIgnore) {\n    let keysToMap = Object.keys(obj)\n    return keysToMap.reduce((res, key) => {\n        if (!keysToIgnore.includes(key)) {\n            res[key] = fn(obj[key]);\n            return res\n        }\n        res[key] = obj[key];\n        return res\n\n    }, {})\n}\n\nfunction deepMap(obj, fn, keysToIgnore = []) {\n    const deepMapper = (val) =>\n        val !== null && typeof val === \"object\" ? deepMap(val, fn) : fn(val)\n    if (Array.isArray(obj)) {\n        return obj.map(deepMapper)\n    }\n    if (typeof obj === \"object\") {\n        return mapObject(obj, deepMapper, keysToIgnore)\n    }\n    return obj\n}\n\nexport { deepMap }\n","import React, {\r\n  useState,\r\n  useEffect,\r\n  useMemo,\r\n  useRef,\r\n  useCallback\r\n} from \"react\"\r\nimport { AgGridReact } from \"ag-grid-react\"\r\nimport { RowClassParams } from 'ag-grid-community';\r\n\r\nimport toastr from \"toastr\"\r\nimport \"toastr/build/toastr.min.css\"\r\nimport \"ag-grid-community/styles/ag-grid.css\"\r\nimport \"ag-grid-community/styles/ag-theme-alpine.css\"\r\nimport \"ag-grid-community/styles/ag-theme-balham.css\"\r\nimport \"ag-grid-community/styles/ag-theme-material.css\"\r\nimport MyModal from './components/Modal'\r\nimport \"ag-grid-enterprise\"\r\nimport { parseISO, compareAsc, set, sub } from \"date-fns\"\r\nimport { format } from \"date-fns-tz\"\r\nimport { duration } from \"moment\"\r\nimport \"./styles.css\"\r\nimport axios from \"axios\"\r\n// import { io } from \"socket.io-client\";\r\n\r\nimport {\r\n  ComponentProps,\r\n  Streamlit,\r\n  withStreamlitConnection,\r\n} from \"streamlit-component-lib\"\r\nimport {\r\n  ColDef,\r\n  ColGroupDef,\r\n  ColumnResizedEvent,\r\n  GetRowIdFunc,\r\n  GetRowIdParams,\r\n  Grid,\r\n  GridOptions,\r\n  GridReadyEvent,\r\n  SideBarDef,\r\n  ValueParserParams,\r\n} from \"ag-grid-community\"\r\nimport {deepMap} from \"./utils\"\r\n\r\n\r\ntype Props = {\r\n  username: string\r\n  api: string\r\n  api_update: string\r\n  refresh_sec?: number\r\n  refresh_cutoff_sec?: number\r\n  gridoption_build?: any\r\n  prod?: boolean\r\n  grid_options?: any\r\n  index: string\r\n  enable_JsCode: boolean\r\n  nestedGridEnabled?: boolean\r\n  nested_columnDefs?: any[]\r\n  kwargs: any,\r\n}\r\n\r\nlet g_rowdata: any[] = []\r\nlet g_newRowData: any = null\r\n\r\n\r\nfunction dateFormatter(isoString: string, formaterString: string): String {\r\n  try {\r\n    let date = new Date(isoString)\r\n    return format(date, formaterString)\r\n  } catch {\r\n    return isoString\r\n  } finally {\r\n  }\r\n}\r\n\r\nfunction currencyFormatter(number: any, currencySymbol: string): String {\r\n  let n = Number.parseFloat(number)\r\n  if (!Number.isNaN(n)) {\r\n    return currencySymbol + n.toFixed(2)\r\n  } else {\r\n    return number\r\n  }\r\n}\r\n\r\nfunction numberFormatter(number: any, precision: number): String {\r\n  let n = Number.parseFloat(number)\r\n  if (!Number.isNaN(n)) {\r\n    return n.toFixed(precision)\r\n  } else {\r\n    return number\r\n  }\r\n}\r\n\r\nconst columnFormaters = {\r\n  columnTypes: {\r\n    dateColumnFilter: {\r\n      filter: \"agDateColumnFilter\",\r\n      filterParams: {\r\n        comparator: (filterValue: any, cellValue: string) =>\r\n          compareAsc(parseISO(cellValue), filterValue),\r\n      },\r\n    },\r\n    numberColumnFilter: {\r\n      filter: \"agNumberColumnFilter\",\r\n    },\r\n    shortDateTimeFormat: {\r\n      valueFormatter: (params: any) =>\r\n        dateFormatter(params.value, \"dd/MM/yyyy HH:mm\"),\r\n    },\r\n    customDateTimeFormat: {\r\n      valueFormatter: (params: any) =>\r\n        dateFormatter(params.value, params.column.colDef.custom_format_string),\r\n    },\r\n    customNumericFormat: {\r\n      valueFormatter: (params: any) =>\r\n        numberFormatter(params.value, params.column.colDef.precision ?? 2),\r\n    },\r\n    customCurrencyFormat: {\r\n      valueFormatter: (params: any) =>\r\n        currencyFormatter(\r\n          params.value,\r\n          params.column.colDef.custom_currency_symbol\r\n        ),\r\n    },\r\n    timedeltaFormat: {\r\n      valueFormatter: (params: any) => duration(params.value).humanize(true),\r\n    },\r\n  },\r\n}\r\n\r\nconst HyperlinkRenderer = (props: any) => {\r\n  const linkField = props.column.colDef[\"linkField\"];\r\n  const baseURL = props.column.colDef.baseURL;\r\n  const linkValue = props.data && linkField ? props.data[linkField] : null;\r\n\r\n  // Only render a link for real data rows\r\n  if (linkValue && baseURL) {\r\n    return (\r\n      <a href={`${baseURL}/${linkValue}`} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        {props.value}\r\n      </a>\r\n    );\r\n  }\r\n  // For pivot/group/total rows, just render the value\r\n  return <span>{props.value}</span>;\r\n};\r\n\r\n\r\ntoastr.options = {\r\n  positionClass: \"toast-top-full-width\",\r\n  hideDuration: 300,\r\n  timeOut: 3000,\r\n}\r\n\r\nconst AgGrid = (props: Props) => {\r\n  const BtnCellRenderer = (props: any) => {\r\n    const btnClickedHandler = () => {\r\n      props.clicked(props.node.id)\r\n    }\r\n    // console.log(\"props.cellStyle\", props.cellStyle)\r\n    return (\r\n      <button\r\n        onClick={btnClickedHandler}\r\n        style={{\r\n          background: \"transparent\",\r\n          border: (props.cellStyle && props.cellStyle.border !== undefined)\r\n            ? props.cellStyle.border\r\n            : \"none\",          \r\n          width: props.width ? props.width : \"100%\",\r\n              ...(props.cellStyle || {}), // <-- Merge in cellStyle from params ? NOT WORKING?\r\n        }}\r\n      >\r\n        {props.col_header ? props.value : props.buttonName}\r\n      </button>\r\n    )\r\n  }\r\n\r\n    const getGridOptions = () => {\r\n    let options = { ...grid_options };\r\n\r\n    if (props.nestedGridEnabled && props.nested_columnDefs) {\r\n      options.masterDetail = true;\r\n      options.detailCellRendererParams = {\r\n        detailGridOptions: {\r\n          columnDefs: props.nested_columnDefs,\r\n        },\r\n        getDetailRowData: (params: any) => {\r\n          params.successCallback(params.data.nestedRows || []);\r\n        },\r\n      };\r\n    } else {\r\n      options.masterDetail = false;\r\n      options.detailCellRendererParams = undefined;\r\n    }\r\n\r\n    return options;\r\n  };\r\n\r\n\r\n  const gridRef = useRef<AgGridReact>(null)\r\n  const {\r\n    username,\r\n    api,\r\n    api_update,\r\n    refresh_sec = undefined,\r\n    refresh_cutoff_sec = 0,\r\n    prod = true,\r\n    index,\r\n    enable_JsCode,\r\n    kwargs,\r\n  } = props\r\n  let { grid_options = {} } = props\r\n\r\n  //parsing must be done here. For some unknow reason if its moved after the\r\n  //button mapping, deepMap gets lots of React objects (api, symbolRefs, etc.)\r\n  //this impacts performance and crashes the grid.\r\n  if (enable_JsCode) {\r\n    grid_options = deepMap(grid_options, parseJsCodeFromPython, [\"rowData\"])\r\n  }\r\n\r\n  const [subtotalsRow, setSubtotalsRow] = useState<any[]>([]);\r\n  let { buttons, toggle_views, api_key, api_lastmod_key = null, columnOrder=[], \r\n    refresh_success=null, total_col=false, subtotal_cols=[], filter_button=''} = kwargs\r\n  const [rowData, setRowData] = useState<any[]>([])\r\n  const [modalShow, setModalshow] = useState(false)\r\n  const [modalData, setModalData] = useState({})\r\n  const [promptText, setPromptText] = useState(\"\")\r\n  const [viewId, setViewId] = useState(0)\r\n  const [lastModified, setLastModified] = useState<string | null>(null);\r\n  const [previousViewId, setpreviousViewId] = useState(89)\r\n  const [activeFilter, setActiveFilter] = useState<string | null>(null);\r\n\r\n  const checkLastModified = async (): Promise<boolean> => {\r\n    try {\r\n      if (api_lastmod_key === null) {\r\n        console.log(\"api key is null, returning false\");\r\n        return true;\r\n      }\r\n      if (api_lastmod_key !== null && api_lastmod_key !== undefined) {\r\n        const baseurl = api.split('/').slice(0, -1).join('/');\r\n        const res = await axios.get(`${baseurl}/lastmod_key`, {\r\n          params: {\r\n            api_key: api_key,\r\n            client_user: username,\r\n            prod: prod,\r\n            api_lastmod_key: api_lastmod_key,\r\n          },\r\n        });\r\n        // console.log(\"fetching data...\", res.data.lastModified);\r\n        if (res.data?.lastModified !== lastModified) {\r\n          // console.log(\"setting modified changed, fetching data...\", res.data.lastModified, lastModified);\r\n          setLastModified(res.data.lastModified);\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      }\r\n      return false;\r\n    } catch (error: any) {\r\n      toastr.error(`Failed to check last modified: ${error.message}`);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const checkViewIdChanged = async (currentViewId: number, previousViewId: number): Promise<boolean> => {\r\n    if (currentViewId !== previousViewId) {\r\n      // console.log(\"viewId has changed from\", previousViewId, \"to\", currentViewId);\r\n      setpreviousViewId(currentViewId);\r\n      return true;\r\n    } else {\r\n      // console.log(\"viewId has not changed\");\r\n      return false;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    Streamlit.setFrameHeight();\r\n  \r\n    if (buttons.length) {\r\n      buttons = deepMap(buttons, parseJsCodeFromPython, [\"rowData\"]); // process JsCode from buttons props\r\n  \r\n      buttons.forEach((button: any) => {\r\n        const {\r\n          prompt_field,\r\n          prompt_message,\r\n          button_api,\r\n          prompt_order_rules,\r\n          col_header,\r\n          col_headername,\r\n          col_width,\r\n          pinned,\r\n          button_name,\r\n          border_color,\r\n          border,\r\n          add_symbol_row_info,\r\n          display_grid_column,\r\n          editableCols,\r\n          ...otherKeys\r\n        } = button;\r\n\r\n        let filterParams = button.filterParams || {};\r\n        if (kwargs['filter_apply']) {\r\n          filterParams = { ...filterParams, buttons: ['apply', 'reset'] };\r\n        }\r\n\r\n        grid_options.columnDefs!.push({\r\n          ...otherKeys,\r\n          field: col_header || index,\r\n          headerName: col_headername,\r\n          width: col_width,\r\n          pinned: pinned,\r\n          cellRenderer: BtnCellRenderer,\r\n          filterParams,\r\n          cellRendererParams: {\r\n            col_header,\r\n            buttonName: button_name,\r\n            borderColor: border_color,\r\n            border: border,\r\n            filterParams,\r\n            cellStyle: button.cellStyle,\r\n            ...(button.cellRendererParams || {}),\r\n            clicked: async function (row_index: any) {\r\n              try {\r\n                const selectedRow = g_rowdata.find((row) => row[index] === row_index);\r\n                if (prompt_order_rules) {\r\n                  const str = selectedRow[prompt_field];\r\n                  const selectedField =\r\n                    typeof str === \"string\"\r\n                      ? JSON.parse(\r\n                          selectedRow[prompt_field]\r\n                            .replace(/'/g, '\"')\r\n                            .replace(/\\n/g, \"\")\r\n                            .replace(/\\s/g, \"\")\r\n                            .replace(/False/g, \"false\")\r\n                            .replace(/True/g, \"true\")\r\n                        )\r\n                      : str;\r\n  \r\n                  setModalshow(true);\r\n                  setModalData({\r\n                    prompt_message,\r\n                    button_api: button_api,\r\n                    username: username,\r\n                    prod: prod,\r\n                    selectedRow: selectedRow,\r\n                    kwargs: kwargs,\r\n                    prompt_field,\r\n                    prompt_order_rules,\r\n                    selectedField,\r\n                    add_symbol_row_info,\r\n                    display_grid_column,\r\n                    editableCols,\r\n                  });\r\n  \r\n                  const rules_value: any = {};\r\n                  prompt_order_rules.forEach((rule: string) => {\r\n                    rules_value[rule] = selectedField[rule];\r\n                  });\r\n  \r\n                  setPromptText(rules_value);\r\n                } else if (prompt_field && prompt_message) {\r\n                  setModalshow(true);\r\n                  setModalData({\r\n                    prompt_message,\r\n                    button_api: button_api,\r\n                    username: username,\r\n                    prod: prod,\r\n                    selectedRow: selectedRow,\r\n                    kwargs: kwargs,\r\n                  });\r\n                  setPromptText(selectedRow[prompt_field]);\r\n                } else {\r\n                  if (window.confirm(prompt_message)) {\r\n                    await axios.post(button_api, {\r\n                      username: username,\r\n                      prod: prod,\r\n                      selected_row: selectedRow,\r\n                      ...kwargs,\r\n                    });\r\n                  }\r\n                  toastr.success(\"Success!\");\r\n                }\r\n              } catch (error) {\r\n                alert(`${error}`);\r\n              }\r\n            },\r\n          },\r\n        });\r\n      });\r\n    }\r\n  \r\n    // Reorder columns based on a predefined list\r\n    // const columnOrder = [\"sector\", \"broker_qty_available\", \"queens_suggested_sell\"]; // Replace with your desired column order\r\n    \r\n    if (columnOrder.length > 0 && grid_options.columnDefs) {\r\n      grid_options.columnDefs.sort((a: any, b: any) => {\r\n      // If both columns are in the columnOrder array, maintain their order\r\n      if (columnOrder.indexOf(a.field) !== -1 && columnOrder.indexOf(b.field) !== -1) {\r\n        return columnOrder.indexOf(a.field) - columnOrder.indexOf(b.field);\r\n      }\r\n    \r\n      // If one of the columns isn't in columnOrder, keep its original position\r\n      if (columnOrder.indexOf(a.field) === -1) return 1;\r\n      if (columnOrder.indexOf(b.field) === -1) return -1;\r\n    \r\n      return 0;\r\n      });\r\n    }\r\n    \r\n  \r\n    // Optional: Refresh header if necessary (if needed)\r\n    if (gridRef.current?.api) {\r\n      gridRef.current.api.refreshHeader();\r\n    }\r\n  }, [buttons, grid_options.columnDefs]);\r\n\r\n  const fetchAndSetData = async () => {\r\n    const array = await fetchData();\r\n    if (array === false) return false;\r\n    setRowData(array);\r\n    g_rowdata = array;\r\n    return true;\r\n  };\r\n\r\n  useEffect(() => {\r\n    onRefresh()\r\n  }, [viewId])\r\n\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      let toggle_view = toggle_views ? toggle_views[viewId] : \"none\";\r\n      const hasViewChanged = await checkViewIdChanged(viewId, previousViewId);\r\n      // console.log(\"hasViewChanged\", hasViewChanged, viewId, previousViewId);\r\n\r\n      // If view has changed, skip checkLastModified\r\n      if (!hasViewChanged && refresh_sec && refresh_sec > 0) {\r\n        const isLastModified = await checkLastModified();\r\n        // console.log(\"isLastModified\", isLastModified, api);\r\n        if (!isLastModified) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      console.log(\"fetching data...\", api);\r\n      const res = await axios.post(api, {\r\n        username: username,\r\n        prod: prod,\r\n        ...kwargs,\r\n        toggle_view_selection: toggle_view\r\n      });\r\n      const array = JSON.parse(res.data);\r\n\r\n\r\n      return array;\r\n    }\r\n    catch (error: any) {\r\n      toastr.error(`Fetch Error: ${error.message}`);\r\n      return false;\r\n    }\r\n  };\r\n\r\n /// for title outside grid\r\n// const [subtotals, setSubtotals] = useState<any>(null);\r\n\r\n// const calculateSubtotals = useCallback(() => {\r\n//   if (!gridRef.current) return;\r\n//   if (!subtotal_cols || subtotal_cols.length === 0) {\r\n//     setSubtotals(null);\r\n//     return;\r\n//   }\r\n//   const api = gridRef.current.api;\r\n//   let filteredRows: any[] = [];\r\n//   api.forEachNodeAfterFilterAndSort((node) => {\r\n//     if (node.data) filteredRows.push(node.data);\r\n//   });\r\n\r\n//   if (filteredRows.length === 0) {\r\n//     setSubtotals(null);\r\n//     return;\r\n//   }\r\n\r\n//   let subtotal: any = {};\r\n//   subtotal[total_col] = \"Subtotal\";\r\n//   subtotal_cols.forEach((col: string) => {\r\n//     subtotal[col] = filteredRows.reduce((sum, row) => sum + (Number(row[col]) || 0), 0);\r\n//   });\r\n\r\n//   setSubtotals(subtotal);\r\n// }, [subtotal_cols, total_col]);\r\n// const onFilterChanged = useCallback(() => {\r\n//   calculateSubtotals();\r\n// }, [calculateSubtotals]);\r\n\r\n// const [subtotalsRow, setSubtotalsRow] = useState<any[]>([]);\r\n\r\nconst calculateSubtotals = useCallback(() => {\r\n  if (!gridRef.current) return;\r\n  if (!subtotal_cols || subtotal_cols.length === 0) {\r\n    setSubtotalsRow([]);\r\n    return;\r\n  }\r\n  const api = gridRef.current.api;\r\n  let filteredRows: any[] = [];\r\n  api.forEachNodeAfterFilterAndSort((node) => {\r\n    if (node.data) filteredRows.push(node.data);\r\n  });\r\n\r\n  if (filteredRows.length === 0) {\r\n    setSubtotalsRow([]);\r\n    return;\r\n  }\r\n\r\nlet subtotal: any = {};\r\n// Ensure total_col is a valid string and exists in the columns\r\nlet allCols: string[] = [];\r\nif (grid_options && grid_options.columnDefs) {\r\n  allCols = grid_options.columnDefs.map((colDef: any) => colDef.field).filter(Boolean);\r\n} else if (filteredRows.length > 0) {\r\n  allCols = Object.keys(filteredRows[0]);\r\n}\r\n\r\n// Place \"subTotals\" label in the correct column\r\nif (typeof total_col === \"string\" && allCols.includes(total_col)) {\r\n  subtotal[total_col] = \"subTotals\";\r\n} else if (allCols.length > 0) {\r\n  subtotal[allCols[0]] = \"subTotals\"; // fallback to first column\r\n}\r\n\r\n// Add button columns if not already present\r\nif (Array.isArray(buttons)) {\r\n  buttons.forEach((btn: any) => {\r\n    if (btn.col_header && !allCols.includes(btn.col_header)) {\r\n      allCols.push(btn.col_header);\r\n    }\r\n  });\r\n}\r\n\r\n\r\nallCols.forEach((col: string) => {\r\n  if (subtotal_cols.includes(col)) {\r\n    // Try to split by $ and sum the numeric part if possible\r\n    const sum = filteredRows.reduce((sum, row) => {\r\n      let val = row[col];\r\n      if (typeof val === \"string\" && val.includes(\"$\")) {\r\n        // Try to extract number after $\r\n        const match = val.match(/\\$([\\d,.\\-]+)/);\r\n        if (match && match[1]) {\r\n          val = match[1].replace(/,/g, \"\");\r\n        }\r\n      }\r\n      const num = Number(val);\r\n      return sum + (isNaN(num) ? 0 : num);\r\n    }, 0);\r\n    subtotal[col] = isNaN(sum) ? \"\" : sum;\r\n  } else if (subtotal[total_col] !== \"subTotals\" || col !== total_col) {\r\n    subtotal[col] = \"\"; // or null, or a placeholder\r\n  }\r\n});\r\n\r\n  setSubtotalsRow([subtotal]);\r\n}, [subtotal_cols, total_col]);\r\nconst onFilterChanged = useCallback(() => {\r\n  calculateSubtotals();\r\n}, [calculateSubtotals]);\r\n\r\n  useEffect(() => {\r\n    if (refresh_sec && refresh_sec > 0) {\r\n      const interval = setInterval(fetchAndSetData, refresh_sec * 1000)\r\n      let timeout: NodeJS.Timeout\r\n      if (refresh_cutoff_sec > 0) {\r\n        console.log(refresh_cutoff_sec)\r\n        timeout = setTimeout(() => {\r\n          clearInterval(interval)\r\n          console.log(\"Fetching data ended, refresh rate:\", refresh_sec)\r\n        }, refresh_cutoff_sec * 1000)\r\n      }\r\n      console.error(\"rendered==========\", props)\r\n      return () => {\r\n        clearInterval(interval)\r\n        if (timeout) clearTimeout(timeout)\r\n      }\r\n    }\r\n  }, [props, viewId])\r\n\r\n  // useEffect(() => {\r\n  //   const baseurl = api.split('/').slice(0, -1).join('/');\r\n  //   const socket = io(`${baseurl}/ws`);\r\n\r\n  //   socket.on(\"dataUpdated\", () => {\r\n  //     console.log(\"Data update received via WebSocket\");\r\n  //     onRefresh();\r\n  //   });\r\n\r\n  //   return () => {\r\n  //     socket.disconnect();\r\n  //   };\r\n  // }, []);\r\n\r\n\r\n  const autoSizeAll = useCallback((skipHeader: boolean) => {\r\n    const allColumnIds: string[] = []\r\n    gridRef.current!.columnApi.getColumns()!.forEach((column: any) => {\r\n      allColumnIds.push(column.getId())\r\n    })\r\n    gridRef.current!.columnApi.autoSizeColumns(allColumnIds, skipHeader)\r\n  }, [])\r\n\r\n  const sizeToFit = useCallback(() => {\r\n    gridRef.current!.api.sizeColumnsToFit({\r\n      defaultMinWidth: 100,\r\n    })\r\n  }, [])\r\n\r\n  const onGridReady = useCallback(async (params: GridReadyEvent) => {\r\n    setTimeout(async () => {\r\n      try {\r\n        const array = await fetchData()\r\n        // console.log(\"AAAAAAAAAAAAAAAAAAAAAAA\", array)\r\n        if (array === false) {\r\n          // toastr.error(`Error: ${array.message}`)\r\n          return\r\n        }\r\n        setRowData(array)\r\n        g_rowdata = array\r\n      \r\n      if (subtotal_cols && subtotal_cols.length > 0) {\r\n        calculateSubtotals();\r\n      } else {\r\n        setSubtotalsRow([]);\r\n      }\r\n\r\n      } catch (error: any) {\r\n        toastr.error(`Error: ${error.message}`)\r\n      }\r\n    }, 100)\r\n  }, [])\r\n\r\n  const autoGroupColumnDef = useMemo<ColDef>(() => {\r\n    return {\r\n      minWidth: 200,\r\n    }\r\n  }, [])\r\n\r\n  const getRowId = useMemo<GetRowIdFunc>(() => {\r\n    return (params: GetRowIdParams) => {\r\n      return params.data[index]\r\n    }\r\n  }, [index])\r\n\r\n  const sideBar = useMemo<\r\n    SideBarDef | string | string[] | boolean | null\r\n  >(() => {\r\n    return {\r\n      toolPanels: [\r\n        {\r\n          id: \"columns\",\r\n          labelDefault: \"Columns\",\r\n          labelKey: \"columns\",\r\n          iconKey: \"columns\",\r\n          toolPanel: \"agColumnsToolPanel\",\r\n        },\r\n        {\r\n          id: \"filters\",\r\n          labelDefault: \"Filters\",\r\n          labelKey: \"filters\",\r\n          iconKey: \"filter\",\r\n          toolPanel: \"agFiltersToolPanel\",\r\n        },\r\n      ],\r\n      defaultToolPanel: \"customStats\",\r\n    }\r\n  }, [])\r\n\r\n  const onCellValueChanged = useCallback((event) => {\r\n    if (g_newRowData === null) g_newRowData = {}\r\n    g_newRowData[event.data[index]] = event.data\r\n    console.log(\"Data after change is\", g_newRowData)\r\n  }, [])\r\n\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const subtotalTimeout = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const onRefresh = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const success = await fetchAndSetData();\r\n      \r\n      refresh_success && success && toastr.success(\"Refresh success!\");\r\n    } catch (error: any) {\r\n      toastr.error(`Refresh Failed! ${error.message}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const onUpdate = async () => {\r\n    if (g_newRowData === null) {\r\n      toastr.warning(`No changes to update`)\r\n      return\r\n    }\r\n    try {\r\n      const res: any = await axios.post(api_update, {\r\n        username: username,\r\n        prod: prod,\r\n        new_data: g_newRowData,\r\n        ...kwargs,\r\n      })\r\n      g_newRowData = null\r\n      if (res.status) toastr.success(`Successfully Updated! `)\r\n      else toastr.error(`Failed! ${res.message}`)\r\n    } catch (error) {\r\n      toastr.error(`Failed! ${error}`)\r\n    }\r\n  }\r\n\r\n  const columnTypes = useMemo<any>(() => {\r\n    return {\r\n      dateColumnFilter: {\r\n        filter: \"agDateColumnFilter\",\r\n        filterParams: {\r\n          comparator: (filterValue: any, cellValue: string) =>\r\n            compareAsc(new Date(cellValue), filterValue),\r\n        },\r\n      },\r\n      numberColumnFilter: {\r\n        filter: \"agNumberColumnFilter\",\r\n      },\r\n      shortDateTimeFormat: {\r\n        valueFormatter: (params: any) =>\r\n          dateFormatter(params.value, \"dd/MM/yyyy HH:mm\"),\r\n      },\r\n      customDateTimeFormat: {\r\n        valueFormatter: (params: any) =>\r\n          dateFormatter(\r\n            params.value,\r\n            params.column.colDef.custom_format_string\r\n          ),\r\n      },\r\n      customNumericFormat: {\r\n        valueFormatter: (params: any) =>\r\n          numberFormatter(params.value, params.column.colDef.precision ?? 2),\r\n      },\r\n      customCurrencyFormat: {\r\n        valueFormatter: (params: any) =>\r\n          currencyFormatter(\r\n            params.value,\r\n            params.column.colDef.custom_currency_symbol\r\n          ),\r\n      },\r\n      timedeltaFormat: {\r\n        valueFormatter: (params: any) => duration(params.value).humanize(true),\r\n      },\r\n      customNumberFormat: {\r\n        valueFormatter: (params: any) =>\r\n          Number(params.value).toLocaleString(\"en-US\", {\r\n            minimumFractionDigits: 0,\r\n          }),\r\n      },\r\n      customHyperlinkRenderer: {\r\n        // valueGetter: (params: any) =>\r\n        //   params.column.colDef.baseURL + params.data.honey,\r\n        cellRenderer: HyperlinkRenderer,\r\n        cellRendererParams: {\r\n          baseURL: \"URLSearchParams.co\",\r\n        },\r\n      },\r\n    }\r\n  }, [])\r\n\r\n  const onClick = () => {\r\n    toastr.clear()\r\n    setTimeout(() => toastr.success(`Settings updated `), 300)\r\n  }\r\n\r\n  type RowStyle = {\r\n    background?: string;\r\n    color?: string;\r\n    fontWeight?: string;\r\n  };\r\n\r\n  function parseJsCodeFromPython(v: string) {\r\n    const JS_PLACEHOLDER = \"::JSCODE::\"\r\n    let funcReg = new RegExp(\r\n      `${JS_PLACEHOLDER}\\\\s*((function|class)\\\\s*.*)\\\\s*${JS_PLACEHOLDER}`\r\n    )\r\n  \r\n    let match = funcReg.exec(v)\r\n  \r\n    if (match) {\r\n  \r\n      const funcStr = match[1]\r\n      // eslint-disable-next-line\r\n      return new Function(\"return \" + funcStr)()\r\n    } else {\r\n      return v\r\n    }\r\n  }\r\n\r\n  const getRowStyle = (params: RowClassParams<any>): RowStyle | undefined => {\r\n        if (params.data && params.data[total_col] === \"subTotals\") {\r\n      return { fontWeight: \"bold\", background: \"#f8f8f8\" }; // Add background if you want\r\n    }\r\n    try {\r\n      const background = params.data[\"color_row\"] ?? undefined;\r\n      const color = params.data[\"color_row_text\"] ?? undefined;\r\n      return { background, color };\r\n    } catch (error) {\r\n      console.error(\"Error accessing row style:\", error);\r\n      return undefined; // Return undefined when an error occurs\r\n    }\r\n  };\r\n\r\n\r\n  const getButtonStyle = (length: number) => {\r\n    if (length < 3) {\r\n      return { padding: \"15px 18px\", fontSize: \"18px\" };\r\n    } else if (length < 8) {\r\n      return { padding: \"15px 18px\", fontSize: \"15px\" };\r\n    } else if (length < 15) {\r\n      return { padding: \"12px 13px\", fontSize: \"13px\" };\r\n    } else if (length < 35) {\r\n      return { padding: \"10px 12px\", fontSize: \"11px\" };\r\n    } else {\r\n      return { padding: \"3px 5px\", fontSize: \"10px\" };\r\n    }\r\n  };\r\n\r\n  const buttonStyle = getButtonStyle(toggle_views.length);\r\n\r\n  const button_color = \"#3498db\"; // Set your custom button color here\r\n\r\n  // let pinnedTopRowData: any[] = [];\r\n  // let filteredRowData = rowData;\r\n  \r\n  // console.log(\"total_col\", total_col)\r\n  // if (total_col) {\r\n  //   // Use total_col as the column to check for \"Total\" row\r\n  //   const totalRow = rowData.find(row => row[total_col] === \"Total\");\r\n  //   pinnedTopRowData = totalRow ? [totalRow] : [];\r\n  //   filteredRowData = rowData.filter(row => row[total_col] !== \"Total\");\r\n  // }\r\n\r\n\r\n  const getUniqueColumnValues = (column: string, rowData: any[]) => {\r\n    return Array.from(new Set(rowData.map(row => row[column]))).filter(\r\n      v => v !== undefined && v !== null\r\n    );\r\n  };\r\n// let filter_button = \"piece_name\";\r\n\r\nconst uniqueValues = useMemo(\r\n  () => getUniqueColumnValues(filter_button, rowData),\r\n  [rowData, filter_button]\r\n);\r\n\r\nconst handleButtonFilter = (value: string | null) => {\r\n  setActiveFilter(value);\r\n\r\n  if (gridRef.current && gridRef.current.api) {\r\n    const api = gridRef.current.api;\r\n    if (value) {\r\n      api.setFilterModel({\r\n        ...api.getFilterModel(),\r\n        [filter_button]: { filterType: \"set\", values: [value] }\r\n      });\r\n    } else {\r\n      const model = api.getFilterModel();\r\n      delete model[filter_button];\r\n      api.setFilterModel(model);\r\n    }\r\n  }\r\n};\r\n\r\n\r\n  return (\r\n    <>\r\n      <MyModal\r\n        isOpen={modalShow}\r\n        closeModal={() => setModalshow(false)}\r\n        modalData={modalData}\r\n        promptText={promptText}\r\n        setPromptText={setPromptText}\r\n        toastr={toastr}\r\n      />\r\n      <div\r\n        style={{ flexDirection: \"row\", height: \"100%\", width: \"100%\" }}\r\n        id=\"myGrid\"\r\n      >\r\n        <div className=\"d-flex justify-content-between align-items-center\">\r\n          {(refresh_sec == undefined || refresh_sec == 0) && (\r\n            <div style={{ display: \"flex\" }}>\r\n              <div style={{ margin: \"5px 5px 5px 2px\" }}>\r\n                <button\r\n                  className=\"btn\"\r\n                  style={{\r\n                    backgroundColor: button_color,\r\n                    color: \"white\",\r\n                    padding: \"5px 8px\", // Smaller padding\r\n                    fontSize: \"12px\", // Smaller font size\r\n                    borderRadius: \"4px\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    minWidth: \"80px\", // Ensure width stays the same during loading\r\n                  }}\r\n                  onClick={onRefresh}\r\n                  disabled={loading} // Disable button while loading\r\n                >\r\n                  {loading ? (\r\n                    <div\r\n                      style={{\r\n                        width: \"14px\",\r\n                        height: \"14px\",\r\n                        border: \"2px solid white\",\r\n                        borderTop: \"2px solid transparent\",\r\n                        borderRadius: \"50%\",\r\n                        animation: \"spin 0.8s linear infinite\",\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    \"Refresh\"\r\n                  )}\r\n                </button>\r\n\r\n                {/* Add CSS for spinner animation */}\r\n                <style>\r\n                  {`\r\n                    @keyframes spin {\r\n                      to {\r\n                        transform: rotate(360deg);\r\n                      }\r\n                    }\r\n                  `}\r\n                </style>\r\n              </div>\r\n              <div style={{ margin: \"5px 5px 5px 2px\" }}>\r\n                <button\r\n                  className=\"btn\"\r\n                  style={{\r\n                    backgroundColor: \"green\",\r\n                    color: \"white\",\r\n                    padding: \"5px 8px\", // Smaller padding\r\n                    fontSize: \"12px\", // Smaller font size\r\n                    borderRadius: \"4px\",\r\n                  }}\r\n                  onClick={onUpdate}\r\n                >\r\n                  Update\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {toggle_views && toggle_views.length > 0 && (\r\n  <>\r\n    {toggle_views.length < 20 ? (\r\n      // Render normal buttons if toggle_views is less than 20\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          flexWrap: \"wrap\",\r\n          gap: \"10px\",\r\n          padding: \"10px\",\r\n          marginBottom: \"10px\",\r\n        }}\r\n      >\r\n        {toggle_views.map((view: string, index: number) => (\r\n          <button\r\n            key={index}\r\n            className={`btn ${viewId === index ? \"btn-danger\" : \"btn-secondary\"}`}\r\n            style={{\r\n              ...buttonStyle,\r\n              borderRadius: \"8px\",\r\n              color: \"#055A6E\",\r\n              backgroundColor: \"#F3FAFD\",\r\n              fontWeight: \"bold\",\r\n            }}\r\n            onClick={() => {\r\n              setViewId(index);\r\n              setpreviousViewId(viewId);\r\n            }}\r\n            disabled={loading}\r\n          >\r\n            {view}\r\n            {loading && viewId === index ? (\r\n              <div\r\n                style={{\r\n                  width: \"14px\",\r\n                  height: \"14px\",\r\n                  border: \"2px solid black\",\r\n                  borderTop: \"2px solid transparent\",\r\n                  borderRadius: \"50%\",\r\n                  animation: \"spin 0.8s linear infinite\",\r\n                  marginLeft: \"8px\",\r\n                }}\r\n              />\r\n            ) : null}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    ) : (\r\n      // Render overlap container if toggle_views is 20 or more\r\n      <div\r\n        className=\"toggle-view-container\"\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"repeat(auto-fit, minmax(100px, 1fr))\",\r\n          gap: \"10px\",\r\n          overflowY: \"auto\",\r\n          maxHeight: \"200px\",\r\n          padding: \"10px\",\r\n          border: \"1px solid #ddd\",\r\n          borderRadius: \"8px\",\r\n          backgroundColor: \"#eef9f8\",\r\n          width: \"100%\",\r\n          marginBottom: \"10px\",\r\n        }}\r\n      >\r\n        {toggle_views.map((view: string, index: number) => (\r\n          <button\r\n            key={index}\r\n            className={`btn ${viewId === index ? \"btn-danger\" : \"btn-secondary\"}`}\r\n            style={{\r\n              ...buttonStyle,\r\n              borderRadius: \"8px\",\r\n              color: \"#055A6E\",\r\n              backgroundColor: \"#F3FAFD\",\r\n              fontWeight: \"bold\",\r\n            }}\r\n            onClick={() => {\r\n              setViewId(index);\r\n              setpreviousViewId(viewId);\r\n            }}\r\n            disabled={loading}\r\n          >\r\n            {view}\r\n            {loading && viewId === index ? (\r\n              <div\r\n                style={{\r\n                  width: \"14px\",\r\n                  height: \"14px\",\r\n                  border: \"2px solid black\",\r\n                  borderTop: \"2px solid transparent\",\r\n                  borderRadius: \"50%\",\r\n                  animation: \"spin 0.8s linear infinite\",\r\n                  marginLeft: \"8px\",\r\n                }}\r\n              />\r\n            ) : null}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    )}\r\n  </>\r\n)}\r\n        </div>\r\n  \r\n        <div\r\n          className={grid_options.theme || \"ag-theme-alpine-dark\"}\r\n          style={{\r\n            width: \"100%\",\r\n            height: kwargs[\"grid_height\"] ? kwargs[\"grid_height\"] : \"100%\",\r\n          }}\r\n        >\r\n          {/* Add test streaming_list_text to kwargs for testing\r\n          {(() => {\r\n            if (!kwargs.streaming_list_text) {\r\n              kwargs.streaming_list_text = [\"some\", \"test\", \"list\"];\r\n            }\r\n            return null;\r\n          })()} */}\r\n          {/* Streamer for streaming_list_text if present */}\r\n          {kwargs.streaming_list_text && Array.isArray(kwargs.streaming_list_text) && (\r\n            <div\r\n              style={{\r\n              width: \"100%\",\r\n              background: \"#F3FAFD\", // Match toggle_views button background\r\n              color: \"#055A6E\",      // Match toggle_views button text color\r\n              padding: \"4px 10px\",\r\n              fontSize: \"13px\",\r\n              borderBottom: \"1px solid #ddd\",\r\n              whiteSpace: \"nowrap\",\r\n              overflow: \"hidden\",\r\n              textOverflow: \"ellipsis\",\r\n              marginBottom: \"4px\",\r\n              fontWeight: \"bold\",    // Match bold style from buttons\r\n              }}\r\n            >\r\n              <div\r\n              style={{\r\n                display: \"block\",\r\n                width: \"100%\",\r\n                whiteSpace: \"nowrap\",\r\n                overflow: \"hidden\",\r\n                position: \"relative\",\r\n              }}\r\n              >\r\n              <div\r\n                style={{\r\n                display: \"inline-block\",\r\n                paddingLeft: \"100%\",\r\n                animation: \"scroll-left 40s linear infinite\",\r\n                }}\r\n              >\r\n                {kwargs.streaming_list_text.join(\"   |   \")}\r\n              </div>\r\n              <style>\r\n                {`\r\n                @keyframes scroll-left {\r\n                  0% {\r\n                  transform: translateX(0%);\r\n                  }\r\n                  100% {\r\n                  transform: translateX(-100%);\r\n                  }\r\n                }\r\n                `}\r\n              </style>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n{kwargs['filter_button'] && kwargs['filter_button'] !== '' && (\r\n  <div style={{ marginBottom: 8 }}>\r\n    {uniqueValues.map(val => (\r\n      <button\r\n        key={val}\r\n        onClick={() => handleButtonFilter(val)}\r\n        style={{\r\n          background: activeFilter === val ? \"#3498db\" : \"#F3FAFD\", // match main button color and toggle_views bg\r\n          color: activeFilter === val ? \"white\" : \"#055A6E\",        // match toggle_views text color\r\n          border: activeFilter === val ? \"2px solid #1abc9c\" : \"1px solid #ddd\",\r\n          borderRadius: \"6px\",\r\n          fontWeight: \"bold\",\r\n          fontSize: \"12px\",\r\n          padding: \"5px 10px\",\r\n          margin: \"0 4px 4px 0\",\r\n          boxShadow: activeFilter === val ? \"0 2px 6px rgba(52,152,219,0.10)\" : \"none\",\r\n          transition: \"all 0.15s\",\r\n          cursor: \"pointer\",\r\n        }}\r\n      >\r\n        {val}\r\n      </button>\r\n    ))}\r\n    <button\r\n      onClick={() => handleButtonFilter(null)}\r\n      style={{\r\n        background: \"#b0c4de\", // blue-grey (LightSteelBlue)\r\n        color: \"#055A6E\",\r\n        border: \"1.5px solid #8fa6bc\",\r\n        borderRadius: \"6px\",\r\n        fontWeight: \"bold\",\r\n        fontSize: \"12px\",\r\n        padding: \"5px 10px\",\r\n        margin: \"0 4px 4px 0\",\r\n        boxShadow: \"0 2px 6px rgba(176,196,222,0.10)\",\r\n        transition: \"all 0.15s\",\r\n        cursor: \"pointer\",\r\n      }}\r\n    >\r\n      Clear\r\n    </button>\r\n  </div>\r\n)}\r\n\r\n\r\n          <AgGridReact\r\n            ref={gridRef}\r\n            rowData={rowData}\r\n            pinnedBottomRowData={subtotalsRow}\r\n            onFilterChanged={onFilterChanged}\r\n            getRowStyle={getRowStyle}\r\n            rowStyle={{ fontSize: 12, padding: 0 }}\r\n            headerHeight={30}\r\n            rowHeight={30}\r\n            onGridReady={onGridReady}\r\n            autoGroupColumnDef={autoGroupColumnDef}\r\n            animateRows={true}\r\n            suppressAggFuncInHeader={true}\r\n            getRowId={getRowId}\r\n            gridOptions={getGridOptions()}\r\n            onCellValueChanged={onCellValueChanged}\r\n            columnTypes={columnTypes}\r\n            sideBar={grid_options.sideBar === false ? false : sideBar}\r\n          />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default AgGrid\r\n","import React, { useEffect, useState } from 'react'\nimport {\n  ComponentProps,\n  Streamlit,\n  withStreamlitConnection,\n} from 'streamlit-component-lib'\nimport 'ag-grid-community/styles/ag-grid.css'\n// import 'ag-grid-community/styles/ag-theme-alpine.css';\nimport 'ag-grid-community/styles/ag-theme-balham.css'\nimport Aggrid from './Aggrid'\n\nconst Main = (props: ComponentProps) => {\n  const {\n    username,\n    api,\n    api_update,\n    refresh_sec,\n    refresh_cutoff_sec,\n    gridoption_build,\n    enable_JsCode,\n    prod,\n  } = props.args\n  const { grid_options, kwargs = {} } = props.args\n  const { index, theme } = grid_options\n  // console.log('GridOptions', grid_options)\n  return (\n    <div>\n      <Aggrid\n        username={username}\n        api={api}\n        api_update={api_update}\n        refresh_sec={refresh_sec}\n        refresh_cutoff_sec={refresh_cutoff_sec}\n        gridoption_build={gridoption_build}\n        prod={prod}\n        grid_options={grid_options}\n        index={index}\n        kwargs={kwargs} \n        enable_JsCode={enable_JsCode}      />\n    </div>\n  )\n}\n\nexport default withStreamlitConnection(Main)\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Main from \"./Main\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <Main />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}