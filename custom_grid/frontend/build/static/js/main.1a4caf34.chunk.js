(this.webpackJsonpstreamlit_custom_slider=this.webpackJsonpstreamlit_custom_slider||[]).push([[0],{130:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var r=a(2),l=a.n(r),o=a(13),n=a.n(o),s=a(22),c=(a(31),a(32),a(47)),i=a(8),m=a.n(i),u=(a(87),a(88),a(89),a(48)),d=a.n(u),p=(a(99),a(133)),f=a(17),g=a(14),b=a.n(g);const y=["YYYY-MM-DDTHH:mm","MM/DD/YYYYTHH:mm","MM/DD/YYYY HH:mm","YYYY-MM-DD HH:mm"];d.a.setAppElement("#root");let h=!1;var x=e=>{let{isOpen:t,closeModal:a,modalData:o,promptText:n,setPromptText:s,toastr:c}=e;const{prompt_field:i,prompt_order_rules:m,selectedRow:u,selectedField:d}=o,g=Object(r.useRef)(null);Object(r.useRef)(null);Object(r.useEffect)(()=>{t&&setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100)},[t]);const x=e=>y.some(t=>b()(e,t,!0).isValid()),v=e=>{const t=b()(e,y,!0).toDate(),a=Intl.DateTimeFormat().resolvedOptions().timeZone,r=Object(f.b)(t,a);return Object(f.a)(r,"yyyy-MM-dd'T'HH:mm")},_=[],w=[],E=[],N=[];if(m)for(const r of m){const e=n[r];Array.isArray(e)?N.push(r):"boolean"===typeof e?w.push(r):x(e)?E.push(r):_.push(r)}return l.a.createElement("div",{className:"my-modal",style:{display:t?"block":"none"}},l.a.createElement("div",{className:"my-modal-content"},l.a.createElement("div",{className:"modal-header px-3 d-flex justify-content-center align-items-center"},l.a.createElement("h4",{className:"text-center m-0"},o.prompt_message),l.a.createElement("span",{className:"close",onClick:a,style:{position:"absolute",right:"20px"}},"\xd7")),l.a.createElement("div",{className:"modal-body p-3"},l.a.createElement("div",{className:"d-flex flex-column"},w.length>0&&l.a.createElement("div",{className:"d-flex flex-row justify-content-between mb-2"},w.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-center",key:t,style:{marginRight:"8px"}},l.a.createElement("label",{className:"mb-0",style:{minWidth:"100px",textAlign:"center",fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"checkbox",checked:n[e],onChange:t=>s({...n,[e]:t.target.checked}),style:{width:"16px",height:"16px",marginTop:"4px"}})))),l.a.createElement("div",{className:"d-flex flex-row justify-content-between"},_.length>0&&l.a.createElement("div",{className:"d-flex flex-column",style:{flex:1,marginRight:"8px"}},_.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"text",value:n[e],onChange:t=>s({...n,[e]:t.target.value}),style:{flex:1,width:"100%",padding:"4px",fontSize:"0.9rem"}})))),E.length>0&&l.a.createElement("div",{className:"d-flex flex-column",style:{flex:1,marginRight:"8px"}},E.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"datetime-local",value:n[e]&&v(n[e]),onChange:t=>s({...n,[e]:t.target.value}),style:{flex:1,width:"100%",padding:"4px",fontSize:"0.9rem"}})))),N.length>0&&l.a.createElement("div",{className:"d-flex flex-column",style:{flex:1}},N.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("select",{value:n[e][0],onChange:t=>s({...n,[e]:[t.target.value]}),style:{flex:1,width:"100%",padding:"4px",fontSize:"0.9rem"}},n[e].map((e,t)=>l.a.createElement("option",{key:t,value:e},e))))))))),l.a.createElement("div",{className:"modal-footer d-flex justify-content-center"},l.a.createElement("button",{type:"button",className:"btn btn-primary mx-2",onClick:async()=>{if(!h){h=!0;try{const e=b()(n.sell_date,y,!0).format("YYYY-MM-DDTHH:mm"),t={username:o.username,prod:o.prod,selected_row:o.selectedRow,default_value:{...n,sell_date:e},...o.kwargs};console.log("body :>> ",t);const{data:r}=await p.a.post(o.button_api,t),{status:l,data:s,description:i}=r;"success"===l?"fade"===s.message_type?c.success(i,"Success"):alert("Success!\nDescription: "+i):"fade"===s.message_type?c.error(i,"Error"):alert("Error!\nDescription: "+i),0!=(null===s||void 0===s?void 0:s.close_modal)&&a()}catch(e){console.log("error :>> ",e),c.error(e.message)}h=!1}},ref:g},"Ok"),l.a.createElement("button",{type:"button",className:"btn btn-secondary mx-2",onClick:a},"Cancel"))))},v=(a(129),a(135));a(134),a(130);function _(e,t,a){return Object.keys(e).reduce((r,l)=>a.includes(l)?(r[l]=e[l],r):(r[l]=t(e[l]),r),{})}function w(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const r=e=>null!==e&&"object"===typeof e?w(e,t):t(e);return Array.isArray(e)?e.map(r):"object"===typeof e?_(e,r,a):e}let E=[],N=null;function k(e,t){try{let a=new Date(e);return Object(f.a)(a,t)}catch{return e}}function C(e,t){let a=Number.parseFloat(e);return Number.isNaN(a)?e:t+a.toFixed(2)}function D(e,t){let a=Number.parseFloat(e);return Number.isNaN(a)?e:a.toFixed(t)}const F=e=>l.a.createElement("a",{href:"".concat(e.column.colDef.baseURL,"/").concat(e.data[e.column.colDef.linkField]),target:"_blank"},e.value);m.a.options={positionClass:"toast-top-full-width",hideDuration:300,timeOut:3e3};var O=e=>{const t=e=>l.a.createElement("button",{onClick:()=>{e.clicked(e.node.id)},style:{background:"transparent",color:"black",width:"100%",borderColor:e.borderColor?e.borderColor:"black"}},e.col_header?e.value:e.buttonName),a=Object(r.useRef)(null),{username:o,api:n,api_update:i,refresh_sec:u,refresh_cutoff_sec:d=0,prod:f=!0,index:b,enable_JsCode:y,kwargs:h}=e;let{grid_options:_={}}=e;y&&(_=w(_,Z,["rowData"]));let{buttons:O,toggle_views:j}=h;const[S,R]=Object(r.useState)([]),[M,T]=Object(r.useState)(!1),[Y,H]=Object(r.useState)({}),[A,z]=Object(r.useState)(""),[P,I]=Object(r.useState)(0);Object(r.useEffect)(()=>{s.a.setFrameHeight(),O.length&&(O=w(O,Z,["rowData"]),O.map(e=>{const{prompt_field:a,prompt_message:r,button_api:l,prompt_order_rules:n,col_header:s,col_headername:c,col_width:i,pinned:u,button_name:d,border_color:g,...y}=e;_.columnDefs.push({...y,field:s||b,headerName:c,width:i,pinned:u,cellRenderer:t,cellRendererParams:{col_header:s,buttonName:d,borderColor:g,clicked:async function(e){try{const t=E.find(t=>t[b]==e);if(n){const e=t[a],s="string"===typeof e?JSON.parse(t[a].replace(/'/g,'"').replace(/\n/g,"").replace(/\s/g,"").replace(/False/g,"false").replace(/True/g,"true")):e;T(!0),H({prompt_message:r,button_api:l,username:o,prod:f,selectedRow:t,kwargs:h,prompt_field:a,prompt_order_rules:n,selectedField:s});const c={};n.map(e=>{c[e]=s[e]}),z(c)}else if(a&&r)T(!0),H({prompt_message:r,button_api:l,username:o,prod:f,selectedRow:t,kwargs:h}),z(t[a]);else{if(window.confirm(r)){await p.a.post(l,{username:o,prod:f,selected_row:t,...h})}m.a.success("Success!")}}catch(t){alert("".concat(t))}}}})}))}),console.log("GRIDOP",_);const J=async()=>{const e=await U();return!1!==e&&(R(e),E=e,!0)};Object(r.useEffect)(()=>{V()},[P]);const U=async()=>{try{const e=await p.a.post(n,{username:o,prod:f,...h,toggle_view_selection:j?j[P]:"none"}),t=JSON.parse(e.data);return console.log("toggle_views[viewId],viewId :>> ",j[P],P),console.log("table data :>> ",t),0==t.status?(m.a.error("Fetch Error: ".concat(t.message)),!1):t}catch(e){return m.a.error("Fetch Error: ".concat(e.message)),!1}};Object(r.useEffect)(()=>{if(u&&u>0){const t=setInterval(J,1e3*u);let a;return d>0&&(console.log(d),a=setTimeout(()=>{clearInterval(t),console.log("Fetching data ended, refresh rate:",u)},1e3*d)),console.error("rendered==========",e),()=>{clearInterval(t),a&&clearTimeout(a)}}},[e,P]);Object(r.useCallback)(e=>{const t=[];a.current.columnApi.getColumns().forEach(e=>{t.push(e.getId())}),a.current.columnApi.autoSizeColumns(t,e)},[]),Object(r.useCallback)(()=>{a.current.api.sizeColumnsToFit({defaultMinWidth:100})},[]);const G=Object(r.useCallback)(async e=>{setTimeout(async()=>{try{const e=await U();if(0==e)return;R(e),E=e}catch(e){m.a.error("Error: ".concat(e.message))}},100)},[]),K=Object(r.useMemo)(()=>({minWidth:200}),[]),L=Object(r.useMemo)(()=>e=>e.data[b],[b]),W=(Object(r.useMemo)(()=>({toolPanels:[{id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"},{id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filter",toolPanel:"agFiltersToolPanel"}],defaultToolPanel:"customStats"}),[]),Object(r.useCallback)(e=>{null==N&&(N={}),N[e.data[b]]=e.data,console.log("Data after change is",N)},[])),V=async()=>{try{await J()&&m.a.success("Refresh success!")}catch(e){m.a.error("Refresh Failed! ".concat(e.message))}},B=Object(r.useMemo)(()=>({dateColumnFilter:{filter:"agDateColumnFilter",filterParams:{comparator:(e,t)=>Object(v.a)(new Date(t),e)}},numberColumnFilter:{filter:"agNumberColumnFilter"},shortDateTimeFormat:{valueFormatter:e=>k(e.value,"dd/MM/yyyy HH:mm")},customDateTimeFormat:{valueFormatter:e=>k(e.value,e.column.colDef.custom_format_string)},customNumericFormat:{valueFormatter:e=>{var t;return D(e.value,null!==(t=e.column.colDef.precision)&&void 0!==t?t:2)}},customCurrencyFormat:{valueFormatter:e=>C(e.value,e.column.colDef.custom_currency_symbol)},timedeltaFormat:{valueFormatter:e=>Object(g.duration)(e.value).humanize(!0)},customNumberFormat:{valueFormatter:e=>Number(e.value).toLocaleString("en-US",{minimumFractionDigits:0})},customHyperlinkRenderer:{cellRenderer:F,cellRendererParams:{baseURL:"URLSearchParams.co"}}}),[]);function Z(e){let t=new RegExp("".concat("::JSCODE::","\\s*((function|class)\\s*.*)\\s*").concat("::JSCODE::")).exec(e);if(t){const e=t[1];return new Function("return "+e)()}return e}return l.a.createElement(l.a.Fragment,null,l.a.createElement(x,{isOpen:M,closeModal:()=>T(!1),modalData:Y,promptText:A,setPromptText:z,toastr:m.a}),l.a.createElement("div",{style:{flexDirection:"row",height:"100%",width:"100%"},id:"myGrid"},l.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},(void 0==u||0==u)&&l.a.createElement("div",{style:{display:"flex"}},l.a.createElement("div",{style:{margin:"5px 5px 5px 2px"}},l.a.createElement("button",{className:"btn",style:{backgroundColor:"#3498db",color:"white",padding:"5px 8px",fontSize:"12px",borderRadius:"4px"},onClick:V},"Refresh")),l.a.createElement("div",{style:{margin:"5px 5px 5px 2px"}},l.a.createElement("button",{className:"btn",style:{backgroundColor:"green",color:"white",padding:"5px 8px",fontSize:"12px",borderRadius:"4px"},onClick:async()=>{if(null!=N)try{const e=await p.a.post(i,{username:o,prod:f,new_data:N,...h});N=null,e.status?m.a.success("Successfully Updated! "):m.a.error("Failed! ".concat(e.message))}catch(e){m.a.error("Failed! ".concat(e))}else m.a.warning("No changes to update")}},"Update"))),l.a.createElement("div",{className:"d-flex flex-row gap-2"},null===j||void 0===j?void 0:j.map((e,t)=>l.a.createElement("span",{key:t},l.a.createElement("button",{className:"btn ".concat(P===t?"btn-danger":"btn-secondary"),style:{padding:"5px 8px",fontSize:"12px",borderRadius:"4px"},onClick:()=>I(t)},e))))),l.a.createElement("div",{className:_.theme||"ag-theme-alpine-dark",style:{width:"100%",height:h.grid_height?h.grid_height:"100%"}},l.a.createElement(c.AgGridReact,{ref:a,rowData:S,getRowStyle:e=>{try{var t,a;const r=null!==(t=e.data.color_row)&&void 0!==t?t:void 0;return{background:r,color:null!==(a=e.data.color_row_text)&&void 0!==a?a:void 0}}catch(r){return void console.error("Error accessing row style:",r)}},rowStyle:{fontSize:12,padding:0},headerHeight:30,rowHeight:30,onGridReady:G,autoGroupColumnDef:K,animateRows:!0,suppressAggFuncInHeader:!0,getRowId:L,gridOptions:_,onCellValueChanged:W,columnTypes:B}))))};var j=Object(s.b)(e=>{const{username:t,api:a,api_update:r,refresh_sec:o,refresh_cutoff_sec:n,gridoption_build:s,enable_JsCode:c,prod:i}=e.args,{grid_options:m,kwargs:u={}}=e.args,{index:d,theme:p}=m;return console.log("AAAAAAAA",m),l.a.createElement("div",null,l.a.createElement(O,{username:t,api:a,api_update:r,refresh_sec:o,refresh_cutoff_sec:n,gridoption_build:s,prod:i,grid_options:m,index:d,kwargs:u,enable_JsCode:c}))});n.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(j,null)),document.getElementById("root"))},55:function(e,t,a){e.exports=a(131)},99:function(e,t,a){}},[[55,1,2]]]);
//# sourceMappingURL=main.1a4caf34.chunk.js.map