(this.webpackJsonpstreamlit_custom_slider=this.webpackJsonpstreamlit_custom_slider||[]).push([[0],{130:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var r=a(2),o=a.n(r),l=a(13),n=a.n(l),s=a(22),c=(a(31),a(32),a(47)),i=a(8),m=a.n(i),u=(a(87),a(88),a(89),a(48)),d=a.n(u),p=(a(99),a(133)),b=a(16),f=a(17),g=a.n(f);const y=["YYYY-MM-DDTHH:mm","MM/DD/YYYYTHH:mm","MM/DD/YYYY HH:mm","YYYY-MM-DD HH:mm"],v={top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"yellow"};d.a.setAppElement("#root");let h=!1;var _=e=>{let{isOpen:t,closeModal:a,modalData:l,promptText:n,setPromptText:s,toastr:c}=e;const{prompt_field:i,prompt_order_rules:m,selectedRow:u,selectedField:d}=l,f=Object(r.useRef)(null),_=Object(r.useRef)(null),E=async()=>{if(!h){h=!0;try{const e=Object(b.a)(new Date(n.sell_date),"MM/dd/yyyy'T'HH:mm"),t={username:l.username,prod:l.prod,selected_row:l.selectedRow,default_value:{...n,sell_date:e},...l.kwargs};console.log("body :>> ",t);const{data:r}=await p.a.post(l.button_api,t),{status:o,data:s,description:i}=r;"success"===o?"fade"===s.message_type?c.success(i,"Success"):alert("Success!\nDescription: "+i):"fade"===s.message_type?c.error(i,"Error"):alert("Error!\nDescription: "+i),0!=(null===s||void 0===s?void 0:s.close_modal)&&a()}catch(e){console.log("error :>> ",e),c.error(e.message)}h=!1}};Object(r.useEffect)(()=>{t&&setTimeout(()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.focus()},100)},[t]);const w=e=>y.some(t=>g()(e,t,!0).isValid()),N=e=>{const t=new Date(e),a=Intl.DateTimeFormat().resolvedOptions().timeZone,r=Object(b.b)(t,a);return Object(b.a)(r,"yyyy-MM-dd'T'HH:mm")};return Array.isArray(d)?o.a.createElement("div",{className:"my-modal",style:{...v,display:t?"block":"none"}},o.a.createElement("div",{className:"my-modal-content"},o.a.createElement("div",{className:"modal-header px-4"},o.a.createElement("h4",null,l.prompt_message),o.a.createElement("span",{className:"close",onClick:a},"\xd7")),o.a.createElement("div",{className:"modal-body p-2"},o.a.createElement("label",{className:"px-1"},i," "),o.a.createElement("select",{name:"cars",id:"cars",defaultValue:d[0],ref:_},d.map(e=>o.a.createElement("option",{value:e},e)))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:async()=>{var e;if(console.log("selectRef.current.value :>> ",null===(e=_.current)||void 0===e?void 0:e.value),!h){h=!0;try{var t;const e={username:l.username,prod:l.prod,selected_row:l.selectedRow,default_value:null===(t=_.current)||void 0===t?void 0:t.value,...l.kwargs};console.log("body :>> ",e);const{data:r}=await p.a.post(l.button_api,e),{status:o,data:n,description:s}=r;console.log("res :>> ",r),"success"===o?"fade"===n.message_type?c.success(s,"Success"):alert("Success!\nDescription: "+s):"fade"===n.message_type?c.error(s,"Error"):alert("Error!\nDescription: "+s),0!=(null===n||void 0===n?void 0:n.close_modal)&&a()}catch(r){console.log("error :>> ",r),c.error(r.message)}h=!1}},ref:f},"Ok"),o.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:a},"Cancel")))):m?o.a.createElement("div",{className:"my-modal",style:{display:t?"block":"none"}},o.a.createElement("div",{className:"my-modal-content"},o.a.createElement("div",{className:"modal-header px-4"},o.a.createElement("h4",null,l.prompt_message),o.a.createElement("span",{className:"close",onClick:a},"\xd7")),o.a.createElement("div",{className:"modal-body p-2"},o.a.createElement("div",{className:"d-flex flex-column"},m.map((e,t)=>o.a.createElement("div",{className:"d-flex flex-row justify-content-end",key:t},o.a.createElement("label",{className:"d-flex flex-row"},e+": ","boolean"===typeof n[e]?o.a.createElement("input",{type:"checkbox",checked:n[e],onChange:t=>s({...n,[e]:t.target.checked})}):Array.isArray(n[e])?o.a.createElement("select",{value:n[e][0],onChange:t=>s({...n,[e]:[t.target.value]})},n[e].map((e,t)=>o.a.createElement("option",{key:t,value:e},e))):w(n[e])?o.a.createElement("input",{type:"datetime-local",value:n[e]&&N(n[e]),onChange:t=>s({...n,[e]:t.target.value})}):o.a.createElement("input",{type:n[e]&&!w(n[e])?"text":"datetime-local",value:n[e],onChange:t=>s({...n,[e]:t.target.value})})),w(n[e]))))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:E,ref:f},"Ok"),o.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:a},"Cancel")))):null},E=(a(129),a(135));a(134),a(130);let w=[],N=null;function k(e,t){try{let a=new Date(e);return Object(b.a)(a,t)}catch{return e}}function C(e,t){let a=Number.parseFloat(e);return Number.isNaN(a)?e:t+a.toFixed(2)}function F(e,t){let a=Number.parseFloat(e);return Number.isNaN(a)?e:a.toFixed(t)}const D=e=>o.a.createElement("a",{href:"".concat(e.column.colDef.baseURL,"/").concat(e.data[e.column.colDef.linkField]),target:"_blank"},e.value);m.a.options={positionClass:"toast-top-full-width",hideDuration:300,timeOut:3e3};var O=e=>{const t=e=>o.a.createElement("button",{onClick:()=>{e.clicked(e.node.id)},style:{background:"transparent",width:"100%",borderColor:e.borderColor?e.borderColor:"black"}},e.col_header?e.value:e.buttonName),a=Object(r.useRef)(null),{username:l,api:n,api_update:i,refresh_sec:u,refresh_cutoff_sec:d=0,prod:b=!0,index:g,kwargs:y}=e;let{grid_options:v={}}=e;const{buttons:h,toggle_views:O}=y,[x,j]=Object(r.useState)([]),[R,M]=Object(r.useState)(!1),[S,T]=Object(r.useState)({}),[H,A]=Object(r.useState)(""),[Y,P]=Object(r.useState)(0);Object(r.useEffect)(()=>{s.a.setFrameHeight(),h.length&&h.map(e=>{const{prompt_field:a,prompt_message:r,button_api:o,prompt_order_rules:n}=e;v.columnDefs.push({field:e.col_header?e.col_header:g,headerName:e.col_headername,width:e.col_width,pinned:e.pinned,cellRenderer:t,cellRendererParams:{col_header:e.col_header,buttonName:e.button_name,borderColor:e.border_color,clicked:async function(e){try{const t=w.find(t=>t[g]==e);if(n){const e=t[a],s="string"===typeof e?JSON.parse(t[a].replace(/'/g,'"').replace(/\n/g,"").replace(/\s/g,"").replace(/False/g,"false").replace(/True/g,"true")):e;M(!0),T({prompt_message:r,button_api:o,username:l,prod:b,selectedRow:t,kwargs:y,prompt_field:a,prompt_order_rules:n,selectedField:s});const c={};n.map(e=>{c[e]=s[e]}),A(c)}else if(a&&r)M(!0),T({prompt_message:r,button_api:o,username:l,prod:b,selectedRow:t,kwargs:y}),A(t[a]);else{if(window.confirm(r)){await p.a.post(o,{username:l,prod:b,selected_row:t,...y})}m.a.success("Success!")}}catch(t){alert("".concat(t))}}}})})});const I=async()=>{const e=await U();if(!1===e)return!1;const t=a.current.api,r=e.map(e=>e[g]),o=w.map(e=>e[g]),l=e.filter(e=>r.includes(e[g])),n=w.filter(e=>!r.includes(e[g])),s=e.filter(e=>!o.includes(e[g]));return t.applyTransactionAsync({update:l,remove:n,add:s}),w=e,!0};Object(r.useEffect)(()=>{L()},[Y]);const U=async()=>{try{const e=await p.a.post(n,{username:l,prod:b,...y,toggle_view_selection:O?O[Y]:"none"}),t=JSON.parse(e.data);return console.log("toggle_views[viewId],viewId :>> ",O[Y],Y),console.log("table data :>> ",t),0==t.status?(m.a.error("Fetch Error: ".concat(t.message)),!1):t}catch(e){return m.a.error("Fetch Error: ".concat(e.message)),!1}};Object(r.useEffect)(()=>{if(u&&u>0){const t=setInterval(I,1e3*u);let a;return d>0&&(console.log(d),a=setTimeout(()=>{clearInterval(t),console.log("Fetching data ended, refresh rate:",u)},1e3*d)),console.error("rendered==========",e),()=>{clearInterval(t),a&&clearTimeout(a)}}},[e,Y]);Object(r.useCallback)(e=>{const t=[];a.current.columnApi.getColumns().forEach(e=>{t.push(e.getId())}),a.current.columnApi.autoSizeColumns(t,e)},[]),Object(r.useCallback)(()=>{a.current.api.sizeColumnsToFit({defaultMinWidth:100})},[]);const z=Object(r.useCallback)(async e=>{setTimeout(async()=>{try{const e=await U();if(0==e)return;j(e),w=e}catch(e){m.a.error("Error: ".concat(e.message))}},100)},[]),G=Object(r.useMemo)(()=>({minWidth:200}),[]),J=Object(r.useMemo)(()=>e=>e.data[g],[g]),K=(Object(r.useMemo)(()=>({toolPanels:[{id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"},{id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filter",toolPanel:"agFiltersToolPanel"}],defaultToolPanel:"customStats"}),[]),Object(r.useCallback)(e=>{null==N&&(N={}),N[e.data[g]]=e.data,console.log("Data after change is",N)},[])),L=async()=>{try{await I()&&m.a.success("Refresh success!")}catch(e){m.a.error("Refresh Failed! ".concat(e.message))}},V=Object(r.useMemo)(()=>({dateColumnFilter:{filter:"agDateColumnFilter",filterParams:{comparator:(e,t)=>Object(E.a)(new Date(t),e)}},numberColumnFilter:{filter:"agNumberColumnFilter"},shortDateTimeFormat:{valueFormatter:e=>k(e.value,"dd/MM/yyyy HH:mm")},customDateTimeFormat:{valueFormatter:e=>k(e.value,e.column.colDef.custom_format_string)},customNumericFormat:{valueFormatter:e=>{var t;return F(e.value,null!==(t=e.column.colDef.precision)&&void 0!==t?t:2)}},customCurrencyFormat:{valueFormatter:e=>C(e.value,e.column.colDef.custom_currency_symbol)},timedeltaFormat:{valueFormatter:e=>Object(f.duration)(e.value).humanize(!0)},customNumberFormat:{valueFormatter:e=>Number(e.value).toLocaleString("en-US",{minimumFractionDigits:0})},customHyperlinkRenderer:{cellRenderer:D,cellRendererParams:{baseURL:"URLSearchParams.co"}}}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(_,{isOpen:R,closeModal:()=>M(!1),modalData:S,promptText:H,setPromptText:A,toastr:m.a}),o.a.createElement("div",{style:{flexDirection:"row",height:"100%",width:"100"},id:"myGrid"},o.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},(void 0==u||0==u)&&o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{style:{margin:"10px 10px 10px 2px"}},o.a.createElement("button",{className:"btn btn-warning",onClick:L},"Refresh")),o.a.createElement("div",{style:{margin:"10px 10px 10px 2px"}},o.a.createElement("button",{className:"btn btn-success",onClick:async()=>{if(null!=N)try{const e=await p.a.post(i,{username:l,prod:b,new_data:N,...y});N=null,e.status?m.a.success("Successfully Updated! "):m.a.error("Failed! ".concat(e.message))}catch(e){m.a.error("Failed! ".concat(e))}else m.a.warning("No changes to update")}},"Update"))),o.a.createElement("div",{className:"d-flex flex-row gap-6"},null===O||void 0===O?void 0:O.map((e,t)=>o.a.createElement("span",{className:""},o.a.createElement("button",{className:"btn ".concat(Y==t?"btn-danger":"btn-secondary"),onClick:()=>P(t)},e))))),o.a.createElement("div",{className:v.theme||"ag-theme-alpine-dark",style:{width:"100%",height:y.grid_height?y.grid_height:"100%"}},o.a.createElement(c.AgGridReact,{ref:a,rowData:x,getRowStyle:e=>{try{var t,a;const r=null!==(t=e.data.color_row)&&void 0!==t?t:void 0;return{background:r,color:null!==(a=e.data.color_row_text)&&void 0!==a?a:void 0}}catch(r){return void console.error("Error accessing row style:",r)}},rowStyle:{fontSize:12,padding:0},headerHeight:30,rowHeight:30,onGridReady:z,autoGroupColumnDef:G,animateRows:!0,suppressAggFuncInHeader:!0,getRowId:J,gridOptions:v,onCellValueChanged:K,columnTypes:V}))))};var x=Object(s.b)(e=>{const{username:t,api:a,api_update:r,refresh_sec:l,refresh_cutoff_sec:n,gridoption_build:s,prod:c}=e.args,{grid_options:i,kwargs:m={}}=e.args,{index:u,theme:d}=i;return console.log("AAAAAAAA",i),o.a.createElement("div",null,o.a.createElement(O,{username:t,api:a,api_update:r,refresh_sec:l,refresh_cutoff_sec:n,gridoption_build:s,prod:c,grid_options:i,index:u,kwargs:m}))});n.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(x,null)),document.getElementById("root"))},55:function(e,t,a){e.exports=a(131)},99:function(e,t,a){}},[[55,1,2]]]);
//# sourceMappingURL=main.90f6362f.chunk.js.map