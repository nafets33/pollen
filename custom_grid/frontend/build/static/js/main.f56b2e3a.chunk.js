(this.webpackJsonpstreamlit_custom_slider=this.webpackJsonpstreamlit_custom_slider||[]).push([[0],{130:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(13),o=a.n(r),i=a(22),s=(a(31),a(32),a(47)),c=a(8),m=a.n(c),d=(a(87),a(88),a(89),a(48)),u=a.n(d),p=(a(99),a(133)),g=a(17),f=a(16),b=a.n(f);const y=["YYYY-MM-DDTHH:mm","MM/DD/YYYYTHH:mm","MM/DD/YYYY HH:mm","YYYY-MM-DD HH:mm"],x=["buying_power","borrow_power"],h=["Day","Week","Month","Quarter","Quarters","Year"],v=h.map(e=>"".concat(e," Margin"));u.a.setAppElement("#root");let E=!1;var _=e=>{let{isOpen:t,closeModal:a,modalData:r,promptText:o,setPromptText:i,toastr:s}=e;const{prompt_field:c,prompt_order_rules:m,selectedRow:d,selectedField:u}=r,[f,_]=l.a.useState(!1),[w,k]=l.a.useState(!1),N=Object(n.useRef)(null);Object(n.useRef)(null);Object(n.useEffect)(()=>{t&&setTimeout(()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.focus()},100)},[t]);const S=e=>y.some(t=>b()(e,t,!0).isValid()),F=e=>{const t=b()(e,y,!0).toDate(),a=Intl.DateTimeFormat().resolvedOptions().timeZone,n=Object(g.b)(t,a);return Object(g.a)(n,"yyyy-MM-dd'T'HH:mm")},C=[],O=[],D=[],j=[];if(m)for(const n of m){const e=o[n];Array.isArray(e)?j.push(n):"boolean"===typeof e?O.push(n):S(e)?D.push(n):C.push(n)}return l.a.createElement("div",{className:"my-modal",style:{display:t?"block":"none"}},l.a.createElement("div",{className:"my-modal-content"},l.a.createElement("div",{className:"modal-header px-3 d-flex justify-content-center align-items-center"},l.a.createElement("h4",{className:"text-center m-0"},r.prompt_message),l.a.createElement("span",{className:"close",onClick:a,style:{position:"absolute",right:"20px"}},"\xd7")),l.a.createElement("div",{className:"modal-body p-3"},l.a.createElement("div",{className:"d-flex flex-column"},O.length>0&&l.a.createElement("div",{className:"d-flex flex-row justify-content-between mb-2"},O.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-center",key:t,style:{marginRight:"8px"}},l.a.createElement("label",{className:"mb-0",style:{minWidth:"100px",textAlign:"center",fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"checkbox",checked:o[e],onChange:t=>i({...o,[e]:t.target.checked}),style:{width:"16px",height:"16px",marginTop:"4px"}})))),l.a.createElement("div",{className:"d-flex flex-row justify-content-between"},C.length>0&&l.a.createElement("div",{className:"d-flex flex-column",style:{flex:1,marginRight:"8px"}},C.map((e,t)=>{if(h.includes(e))return null;if(v.includes(e))return null;const a=x.includes(e);return l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":","sell_amount"===e&&l.a.createElement("span",{style:{marginLeft:"4px",cursor:"pointer"},title:"This amount will override sell_qty"},"\u2753")),a?l.a.createElement(l.a.Fragment,null,l.a.createElement("input",{type:"range",min:"0",max:"1",step:".01",value:o[e]||0,onChange:t=>i({...o,[e]:Number(t.target.value)}),style:{width:"100%"}}),l.a.createElement("span",{style:{fontSize:"0.9rem",fontWeight:"bold",marginTop:"4px"}},o[e]||0)):l.a.createElement("input",{type:"text",value:o[e],onChange:t=>i({...o,[e]:t.target.value}),style:{flex:1,width:"100%",padding:"4px",fontSize:"0.9rem"}}))})),j.length>0&&l.a.createElement("div",{className:"d-flex flex-column",style:{flex:1}},j.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("select",{value:o[e][0],onChange:t=>i({...o,[e]:[t.target.value]}),style:{flex:1,width:"100%",padding:"4px",fontSize:"0.9rem"}},o[e].map((e,t)=>l.a.createElement("option",{key:t,value:e},e)))))),h.some(e=>null===m||void 0===m?void 0:m.includes(e))&&l.a.createElement("div",{style:{flex:1,marginRight:"8px"}},l.a.createElement("div",{style:{cursor:"pointer",fontWeight:"bold",marginBottom:"4px"},onClick:()=>_(e=>!e)},f?"\u25bc":"\u25ba"," Advanced Allocation Options"),f&&l.a.createElement("div",null,h.map((e,t)=>(null===m||void 0===m?void 0:m.includes(e))&&void 0!==o[e]&&l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"range",min:"0",max:"1",step:".01",value:o[e]||0,onChange:t=>i({...o,[e]:Number(t.target.value)}),style:{width:"100%"}}),l.a.createElement("span",{style:{fontSize:"0.9rem",fontWeight:"bold",marginTop:"4px"}},o[e]||0))))),v.some(e=>null===m||void 0===m?void 0:m.includes(e))&&l.a.createElement("div",{style:{flex:1,marginRight:"8px"}},l.a.createElement("div",{style:{cursor:"pointer",fontWeight:"bold",marginBottom:"4px"},onClick:()=>k(e=>!e)},w?"\u25bc":"\u25ba"," Advanced Margin Allocation Options"),w&&l.a.createElement("div",null,v.map((e,t)=>(null===m||void 0===m?void 0:m.includes(e))&&void 0!==o[e]&&l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"range",min:"0",max:"1",step:".01",value:o[e]||0,onChange:t=>i({...o,[e]:Number(t.target.value)}),style:{width:"100%"}}),l.a.createElement("span",{style:{fontSize:"0.9rem",fontWeight:"bold",marginTop:"4px"}},o[e]||0))))),D.length>0&&l.a.createElement("div",{className:"d-flex flex-column",style:{flex:1,marginRight:"8px"}},D.map((e,t)=>l.a.createElement("div",{className:"d-flex flex-column align-items-start mb-1",key:t},l.a.createElement("label",{className:"mb-0",style:{fontSize:"0.9rem"}},e,":"),l.a.createElement("input",{type:"datetime-local",value:o[e]&&F(o[e]),onChange:t=>i({...o,[e]:t.target.value}),style:{flex:1,width:"100%",padding:"4px",fontSize:"0.9rem"}}))))))),d&&void 0!==d.current_ask&&l.a.createElement("div",null,l.a.createElement("b",null,"current_ask: "),Number(d.current_ask).toLocaleString(void 0,{maximumFractionDigits:2})),d&&void 0!==d.ticker_total_budget&&l.a.createElement("div",null,l.a.createElement("b",null,"Total Budget:$ "),Number(d.ticker_total_budget).toLocaleString(void 0,{maximumFractionDigits:0})),d&&void 0!==d.star_buys_at_play&&l.a.createElement("div",null,l.a.createElement("b",null,"Currently Long:$ "),Number(d.star_buys_at_play).toLocaleString(void 0,{maximumFractionDigits:0})),d&&void 0!==d.ticker_remaining_budget&&l.a.createElement("div",null,l.a.createElement("b",null,"Remaining Budget:$ "),Number(d.ticker_remaining_budget).toLocaleString(void 0,{maximumFractionDigits:0})),l.a.createElement("div",{className:"modal-footer d-flex justify-content-center"},l.a.createElement("button",{type:"button",className:"btn btn-primary mx-2",onClick:async()=>{if(!E){E=!0;try{const e={username:r.username,prod:r.prod,selected_row:r.selectedRow,default_value:o,...r.kwargs};console.log("body :>> ",e);const{data:t}=await p.a.post(r.button_api,e),{status:n,data:l,description:i}=t;"success"===n?"fade"===l.message_type?s.success(i,"Success"):alert("Success!\nDescription: "+i):"fade"===l.message_type?s.error(i,"Error"):alert("Error!\nDescription: "+i),0!=(null===l||void 0===l?void 0:l.close_modal)&&a()}catch(e){console.log("error :>> ",e),s.error(e.message)}E=!1}},ref:N},"Ok"),l.a.createElement("button",{type:"button",className:"btn btn-secondary mx-2",onClick:a},"Cancel"))))},w=(a(129),a(135));a(134),a(130);function k(e,t,a){return Object.keys(e).reduce((n,l)=>a.includes(l)?(n[l]=e[l],n):(n[l]=t(e[l]),n),{})}function N(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const n=e=>null!==e&&"object"===typeof e?N(e,t):t(e);return Array.isArray(e)?e.map(n):"object"===typeof e?k(e,n,a):e}let S=[],F=null;function C(e,t){try{let a=new Date(e);return Object(g.a)(a,t)}catch{return e}}function O(e,t){let a=Number.parseFloat(e);return Number.isNaN(a)?e:t+a.toFixed(2)}function D(e,t){let a=Number.parseFloat(e);return Number.isNaN(a)?e:a.toFixed(t)}const j=e=>l.a.createElement("a",{href:"".concat(e.column.colDef.baseURL,"/").concat(e.data[e.column.colDef.linkField]),target:"_blank"},e.value);m.a.options={positionClass:"toast-top-full-width",hideDuration:300,timeOut:3e3};var R=e=>{const t=e=>l.a.createElement("button",{onClick:()=>{e.clicked(e.node.id)},style:{background:"transparent",border:e.cellStyle&&void 0!==e.cellStyle.border?e.cellStyle.border:"none",width:e.width?e.width:"100%",...e.cellStyle||{}}},e.col_header?e.value:e.buttonName),a=Object(n.useRef)(null),{username:r,api:o,api_update:c,refresh_sec:d,refresh_cutoff_sec:u=0,prod:g=!0,index:b,enable_JsCode:y,kwargs:x}=e;let{grid_options:h={}}=e;y&&(h=N(h,re,["rowData"]));let{buttons:v,toggle_views:E,api_key:k,api_lastmod_key:R=null,columnOrder:T=[],grid_type:M=null}=x;const[z,H]=Object(n.useState)([]),[A,Y]=Object(n.useState)(!1),[L,P]=Object(n.useState)({}),[W,I]=Object(n.useState)(""),[J,B]=Object(n.useState)(0),[U,G]=Object(n.useState)(null),[K,$]=Object(n.useState)(89);Object(n.useEffect)(()=>{var e;i.a.setFrameHeight(),v.length&&(v=N(v,re,["rowData"]),v.forEach(e=>{const{prompt_field:a,prompt_message:n,button_api:l,prompt_order_rules:o,col_header:i,col_headername:s,col_width:c,pinned:d,button_name:u,border_color:f,border:y,...v}=e;h.columnDefs.push({...v,field:i||b,headerName:s,width:c,pinned:d,cellRenderer:t,cellRendererParams:{col_header:i,buttonName:u,borderColor:f,border:y,...e.cellRendererParams||{},clicked:async function(e){try{const t=S.find(t=>t[b]===e);if(o){const e=t[a],i="string"===typeof e?JSON.parse(t[a].replace(/'/g,'"').replace(/\n/g,"").replace(/\s/g,"").replace(/False/g,"false").replace(/True/g,"true")):e;Y(!0),P({prompt_message:n,button_api:l,username:r,prod:g,selectedRow:t,kwargs:x,prompt_field:a,prompt_order_rules:o,selectedField:i});const s={};o.forEach(e=>{s[e]=i[e]}),I(s)}else a&&n?(Y(!0),P({prompt_message:n,button_api:l,username:r,prod:g,selectedRow:t,kwargs:x}),I(t[a])):(window.confirm(n)&&await p.a.post(l,{username:r,prod:g,selected_row:t,...x}),m.a.success("Success!"))}catch(t){alert("".concat(t))}}}})})),T.length>0&&h.columnDefs&&h.columnDefs.sort((e,t)=>-1!==T.indexOf(e.field)&&-1!==T.indexOf(t.field)?T.indexOf(e.field)-T.indexOf(t.field):-1===T.indexOf(e.field)?1:-1===T.indexOf(t.field)?-1:0),(null===(e=a.current)||void 0===e?void 0:e.api)&&a.current.api.refreshHeader()},[v,h.columnDefs]);const Q=async()=>{const e=await V();return!1!==e&&(H(e),S=e,!0)};Object(n.useEffect)(()=>{ne()},[J]);const V=async()=>{try{let e=E?E[J]:"none";if(d&&d>0){const e=await(async()=>{try{if(console.log("checking last modified...",R),null===R)return console.log("api key is null, returning false"),!0;if(null!==R&&void 0!==R){var e;const t=o.split("/").slice(0,-1).join("/");console.log("api key",R);const a=await p.a.get("".concat(t,"/lastmod_key"),{params:{api_key:k,client_user:r,prod:g,api_lastmod_key:R}});return(null===(e=a.data)||void 0===e?void 0:e.lastModified)!==U&&(G(a.data.lastModified),!0)}return!1}catch(t){return m.a.error("Failed to check last modified: ".concat(t.message)),!1}})();if(console.log("isLastModified",e,o),!e)return!1}console.log("fetching data...",o);const t=await p.a.post(o,{username:r,prod:g,...x,toggle_view_selection:e});return JSON.parse(t.data)}catch(e){return m.a.error("Fetch Error: ".concat(e.message)),!1}};Object(n.useEffect)(()=>{if(d&&d>0){const t=setInterval(Q,1e3*d);let a;return u>0&&(console.log(u),a=setTimeout(()=>{clearInterval(t),console.log("Fetching data ended, refresh rate:",d)},1e3*u)),console.error("rendered==========",e),()=>{clearInterval(t),a&&clearTimeout(a)}}},[e,J]);Object(n.useCallback)(e=>{const t=[];a.current.columnApi.getColumns().forEach(e=>{t.push(e.getId())}),a.current.columnApi.autoSizeColumns(t,e)},[]),Object(n.useCallback)(()=>{a.current.api.sizeColumnsToFit({defaultMinWidth:100})},[]);const q=Object(n.useCallback)(async e=>{setTimeout(async()=>{try{const e=await V();if(!1===e)return;H(e),S=e}catch(e){m.a.error("Error: ".concat(e.message))}},100)},[]),Z=Object(n.useMemo)(()=>({minWidth:200}),[]),X=Object(n.useMemo)(()=>e=>e.data[b],[b]),ee=(Object(n.useMemo)(()=>({toolPanels:[{id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"},{id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filter",toolPanel:"agFiltersToolPanel"}],defaultToolPanel:"customStats"}),[]),Object(n.useCallback)(e=>{null===F&&(F={}),F[e.data[b]]=e.data,console.log("Data after change is",F)},[])),[te,ae]=Object(n.useState)(!1),ne=async()=>{ae(!0);try{await Q()&&m.a.success("Refresh success!")}catch(e){m.a.error("Refresh Failed! ".concat(e.message))}finally{ae(!1)}},le=Object(n.useMemo)(()=>({dateColumnFilter:{filter:"agDateColumnFilter",filterParams:{comparator:(e,t)=>Object(w.a)(new Date(t),e)}},numberColumnFilter:{filter:"agNumberColumnFilter"},shortDateTimeFormat:{valueFormatter:e=>C(e.value,"dd/MM/yyyy HH:mm")},customDateTimeFormat:{valueFormatter:e=>C(e.value,e.column.colDef.custom_format_string)},customNumericFormat:{valueFormatter:e=>{var t;return D(e.value,null!==(t=e.column.colDef.precision)&&void 0!==t?t:2)}},customCurrencyFormat:{valueFormatter:e=>O(e.value,e.column.colDef.custom_currency_symbol)},timedeltaFormat:{valueFormatter:e=>Object(f.duration)(e.value).humanize(!0)},customNumberFormat:{valueFormatter:e=>Number(e.value).toLocaleString("en-US",{minimumFractionDigits:0})},customHyperlinkRenderer:{cellRenderer:j,cellRendererParams:{baseURL:"URLSearchParams.co"}}}),[]);function re(e){let t=new RegExp("".concat("::JSCODE::","\\s*((function|class)\\s*.*)\\s*").concat("::JSCODE::")).exec(e);if(t){const e=t[1];return new Function("return "+e)()}return e}const oe=(ie=E.length)<3?{padding:"15px 18px",fontSize:"18px"}:ie<8?{padding:"15px 18px",fontSize:"15px"}:ie<15?{padding:"12px 13px",fontSize:"13px"}:ie<35?{padding:"10px 12px",fontSize:"11px"}:{padding:"3px 5px",fontSize:"10px"};var ie;return l.a.createElement(l.a.Fragment,null,l.a.createElement(_,{isOpen:A,closeModal:()=>Y(!1),modalData:L,promptText:W,setPromptText:I,toastr:m.a}),l.a.createElement("div",{style:{flexDirection:"row",height:"100%",width:"100%"},id:"myGrid"},l.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},(void 0==d||0==d)&&l.a.createElement("div",{style:{display:"flex"}},l.a.createElement("div",{style:{margin:"5px 5px 5px 2px"}},l.a.createElement("button",{className:"btn",style:{backgroundColor:"#3498db",color:"white",padding:"5px 8px",fontSize:"12px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"80px"},onClick:ne,disabled:te},te?l.a.createElement("div",{style:{width:"14px",height:"14px",border:"2px solid white",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}):"Refresh"),l.a.createElement("style",null,"\n                    @keyframes spin {\n                      to {\n                        transform: rotate(360deg);\n                      }\n                    }\n                  ")),l.a.createElement("div",{style:{margin:"5px 5px 5px 2px"}},l.a.createElement("button",{className:"btn",style:{backgroundColor:"green",color:"white",padding:"5px 8px",fontSize:"12px",borderRadius:"4px"},onClick:async()=>{if(null!==F)try{const e=await p.a.post(c,{username:r,prod:g,new_data:F,...x});F=null,e.status?m.a.success("Successfully Updated! "):m.a.error("Failed! ".concat(e.message))}catch(e){m.a.error("Failed! ".concat(e))}else m.a.warning("No changes to update")}},"Update"))),E&&E.length>0&&l.a.createElement(l.a.Fragment,null,E.length<20?l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",padding:"10px",marginBottom:"10px"}},E.map((e,t)=>l.a.createElement("button",{key:t,className:"btn ".concat(J===t?"btn-danger":"btn-secondary"),style:{...oe,borderRadius:"8px",color:"#055A6E",backgroundColor:"#F3FAFD",fontWeight:"bold"},onClick:()=>{B(t),$(J)},disabled:te},e,te&&J===t?l.a.createElement("div",{style:{width:"14px",height:"14px",border:"2px solid black",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginLeft:"8px"}}):null))):l.a.createElement("div",{className:"toggle-view-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px",overflowY:"auto",maxHeight:"200px",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#eef9f8",width:"100%",marginBottom:"10px"}},E.map((e,t)=>l.a.createElement("button",{key:t,className:"btn ".concat(J===t?"btn-danger":"btn-secondary"),style:{...oe,borderRadius:"8px",color:"#055A6E",backgroundColor:"#F3FAFD",fontWeight:"bold"},onClick:()=>{B(t),$(J)},disabled:te},e,te&&J===t?l.a.createElement("div",{style:{width:"14px",height:"14px",border:"2px solid black",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginLeft:"8px"}}):null))))),l.a.createElement("div",{className:h.theme||"ag-theme-alpine-dark",style:{width:"100%",height:x.grid_height?x.grid_height:"100%"}},l.a.createElement(s.AgGridReact,{ref:a,rowData:z,getRowStyle:e=>{try{var t,a;const n=null!==(t=e.data.color_row)&&void 0!==t?t:void 0;return{background:n,color:null!==(a=e.data.color_row_text)&&void 0!==a?a:void 0}}catch(n){return void console.error("Error accessing row style:",n)}},rowStyle:{fontSize:12,padding:0},headerHeight:30,rowHeight:30,onGridReady:q,autoGroupColumnDef:Z,animateRows:!0,suppressAggFuncInHeader:!0,getRowId:X,gridOptions:h,onCellValueChanged:ee,columnTypes:le}))))};var T=Object(i.b)(e=>{const{username:t,api:a,api_update:n,refresh_sec:r,refresh_cutoff_sec:o,gridoption_build:i,enable_JsCode:s,prod:c}=e.args,{grid_options:m,kwargs:d={}}=e.args,{index:u,theme:p}=m;return l.a.createElement("div",null,l.a.createElement(R,{username:t,api:a,api_update:n,refresh_sec:r,refresh_cutoff_sec:o,gridoption_build:i,prod:c,grid_options:m,index:u,kwargs:d,enable_JsCode:s}))});o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(T,null)),document.getElementById("root"))},55:function(e,t,a){e.exports=a(131)},99:function(e,t,a){}},[[55,1,2]]]);
//# sourceMappingURL=main.f56b2e3a.chunk.js.map